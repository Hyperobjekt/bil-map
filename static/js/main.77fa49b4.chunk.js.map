{"version":3,"sources":["TriggerIcon.js","fields.js","UserHint.js","CardDock.js","Legend.js","Tooltip.js","App.js","index.js"],"names":["ICON_TYPE","TriggerIcon","props","this","onClick","x1","x2","y1","y2","points","icon","classes","transform","iconType","getRemove","getExpand","getCollapse","getDownArrow","console","error","inBrackets","getBracketWrap","viewBox","className","React","Component","SHEET_FIELDS","LONGITUDE","displayName","sheetId","LATITUDE","EID","NAME","TYPE","LOCATION","DATES","RECIPIENTS","IMPLEMENTER","isExpandible","RESEARCHER","FUNDER","TARGETING","UNIT","AMOUNT","FREQUENCY","EVALUATION","NOTES","WEBSITE","forceUniformValue","LINKURL1","LINKTITLE1","LINKURL2","LINKTITLE2","LINKURL3","LINKTITLE3","LINKURL4","LINKTITLE4","LINKURL5","LINKTITLE5","LINKURL6","LINKTITLE6","LINK_FIELD_PAIRS","urlField","titleField","FEATURE_HEADERS","ORGANIZATIONAL","isFeatureHeader","IMPLEMENTATION","COMPOSITE_FIELDS","RELATED_RESOURCES","ORDERED_CARD_FIELDS","UserHint","dismissed","content","CardDock","state","minimized","expandedProperties","scrollHintDismissed","removeCard","bind","slideDock","toggleDock","maximizeDock","toggleProperty","id","e","deltaY","setState","property","expanded","cardData","map","experimentCardSet","eid","name","key","field","expandible","getIsExpandible","expandIcon","cellClass","valueClass","propertyCells","cellContent","getCellContent","_","some","expCardSet","length","getLocationCellContent","getLinksContent","locationOneData","otherLocationsData","firstValue","uniformValue","every","l","includes","href","target","locationData","location","title","linkMap","orderedLinks","forEach","urlValue","titleValue","push","selectionHintDismissed","onWheel","onDoubleClick","onTouchStart","getScrollHint","getSelectionHint","getNames","getRows","PureComponent","Legend","toggleExpand","Tooltip","left","top","adjusted","ref","createRef","nextProps","expId","x","y","adjustPosition","current","getBoundingClientRect","tooltipWidth","width","tooltipHeight","height","document","getElementById","windowWidth","windowHeight","POINT_BUFFER","otherLocations","hoveredClass","otherLocationElements","type","style","visibility","getLocations","mapboxgl","accessToken","process","App","lat","lng","zoom","hovered","selectedIds","isTouchScreen","getCardDock","getTooltip","getFeaturesByExperimentId","Map","container","mapContainer","styleData","center","on","featuresOnUnhover","log","getCenter","toFixed","getZoom","featuresOnClick","featuresOnHover","touchstart","load","call","getSource","_data","features","filter","f","properties","idx","indexOf","alreadySelected","splice","setFeatureState","source","selected","getCanvas","cursor","point","hover","el","nextEidNumber","eidMap","String","prototype","startsWith","Object","defineProperty","value","search","rawPos","pos","substring","experimentsData","experimentsReq","XMLHttpRequest","addEventListener","req","JSON","parse","responseText","feed","entry","rows","keys","p","endsWith","substr","items","r","ri","row","$t","stringEid","numericEid","toLowerCase","geometry","coordinates","setData","reqHandler","open","send","ReactDOM","render"],"mappings":"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","file":"static/js/main.77fa49b4.chunk.js","sourcesContent":["import React from 'react';\n\nconst ICON_TYPE = {\n  REMOVE: 'remove',\n  EXPAND: 'expand',\n  COLLAPSE: 'collapse',\n  D_ARROW: 'down-arrow',\n  R_ARROW: 'right-arrow'\n};\n\nclass TriggerIcon extends React.Component {\n  constructor(props) {\n    super(props)\n  }\n\n  onClick() {\n    this.props.onClick();\n  }\n\n  getRemove() {\n    return (\n      <>\n        <line x1='15' x2='85' y1='15' y2='85'/>\n        <line x1='15' x2='85' y1='85' y2='15'/>\n      </>\n    )    \n  }\n  \n  getExpand() {\n    return (\n      <>\n        <line x1='15' x2='85' y1='50' y2='50'/>\n        <line x1='50' x2='50' y1='15' y2='85'/>\n      </>\n    )    \n  }\n\n  getCollapse() {\n    return (\n      <>\n        <line x1='20' x2='80' y1='50' y2='50'/>\n      </>\n    )    \n  }\n\n  getDownArrow() {\n    return (\n      <>\n        <polyline points='50,0 50,100' />\n        <polyline points='10,55 50,100 90,55' />\n      </>\n    )\n  }\n  \n  getBracketWrap(icon) {\n    return (\n      <>\n        <polyline points='15,0 0,0 0,100 15,100' />\n          {icon}\n        <polyline points='85,0 100,0 100,100 85,100' />\n      </>\n    )    \n  }\n  \n  render() {\n    let icon;\n    let classes = 'trigger-icon ';\n    let transform = '';\n    switch (this.props.iconType) {\n      case ICON_TYPE.REMOVE:\n        icon = this.getRemove();\n        classes += 'remove-icon';\n        break;\n      case ICON_TYPE.EXPAND:\n        icon = this.getExpand();\n        classes += 'expand-icon';\n        break;\n      case ICON_TYPE.COLLAPSE:\n        icon = this.getCollapse();\n        classes += 'collapse-icon';\n        break;\n      case ICON_TYPE.D_ARROW:\n        icon = this.getDownArrow();\n        classes += 'down-arrow';\n        break;\n      case ICON_TYPE.R_ARROW:\n        icon = this.getDownArrow();\n        classes += 'right-arrow';\n        transform += 'rotate(270)';\n        break;\n      default:\n        console.error('incorrect type');\n    }\n\n    if (this.props.inBrackets) {\n      classes += ' bracketed';\n      icon = this.getBracketWrap(icon);\n    }\n\n    return (\n      <svg\n        onClick={this.props.onClick}\n        viewBox='0 0 100 100'\n        transform={transform}\n        className={classes}\n      >\n        {icon}\n      </svg>\n    )\n  }\n}\n\nexport default TriggerIcon;\nexport { ICON_TYPE };\n","const SHEET_FIELDS = {\n  LONGITUDE: {\n    displayName: 'Longitude', // how the field will appear on the card\n    sheetId: 'longitude' // corresponds to the column header on the google sheet\n  },\n  LATITUDE: {\n    displayName: 'Latitude',\n    sheetId: 'latitude'\n  },\n  // NOTE: Used to bind the different locations of a given experiment together.\n  // We use it as the mapbox ID for the feature to simplify unified hover/selection styling.\n  EID: {\n    displayName: 'Experiment ID',\n    sheetId: 'eid'\n  },\n  NAME: {\n    displayName: 'Name of Experiment',\n    sheetId: 'name'\n  },\n  TYPE: {\n    displayName: 'Past, Ongoing, Proposed',\n    sheetId: 'type'\n  },\n  LOCATION: {\n    displayName: 'Location',\n    sheetId: 'location'\n  },\n  DATES: {\n    displayName: 'Implementation Dates',\n    sheetId: 'dates'\n  },\n  RECIPIENTS: {\n    displayName: 'Number of Recipients',\n    sheetId: 'recipients'\n  },\n  IMPLEMENTER: {\n    displayName: 'Implementing Agency',\n    sheetId: 'implementer',\n    isExpandible: true\n  },\n  RESEARCHER: {\n    displayName: 'Research Agency',\n    sheetId: 'researcher',\n    isExpandible: true\n  },\n  FUNDER: {\n    displayName: 'Funding Agency',\n    sheetId: 'funder',\n    isExpandible: true\n  },\n  TARGETING: {\n    displayName: 'Type of Targeting',\n    sheetId: 'targeting',\n    isExpandible: true\n  },\n  UNIT: {\n    displayName: 'Unit of Recipient',\n    sheetId: 'unit'\n  },\n  AMOUNT: {\n    displayName: 'Amount of Transfer',\n    sheetId: 'amount',\n    isExpandible: true\n  },\n  FREQUENCY: {\n    displayName: 'Frequency of Payment',\n    sheetId: 'frequency'\n  },\n  EVALUATION: {\n    displayName: 'Method of Evaluation',\n    sheetId: 'evaluation'\n  },\n  NOTES: {\n    displayName: 'Additional Notes of Interest',\n    sheetId: 'notes',\n    isExpandible: true\n  },\n  WEBSITE: {\n    displayName: 'Link to Website',\n    sheetId: 'website',\n    forceUniformValue: true\n  },\n  LINKURL1: {\n    displayName: 'Link to Related Resource 1',\n    sheetId: 'linkurl1'\n  },\n  LINKTITLE1: {\n    displayName: 'Link title 1',\n    sheetId: 'linktitle1'\n  },\n  LINKURL2: {\n    displayName: 'Link to Related Resource 2',\n    sheetId: 'linkurl2'\n  },\n  LINKTITLE2: {\n    displayName: 'Link title 2',\n    sheetId: 'linktitle2'\n  },\n  LINKURL3: {\n    displayName: 'Link to Related Resource 3',\n    sheetId: 'linkurl3'\n  },\n  LINKTITLE3: {\n    displayName: 'Link title 3',\n    sheetId: 'linktitle3'\n  },\n  LINKURL4: {\n    displayName: 'Link to Related Resource 4',\n    sheetId: 'linkurl4'\n  },\n  LINKTITLE4: {\n    displayName: 'Link title 4',\n    sheetId: 'linktitle4'\n  },\n  LINKURL5: {\n    displayName: 'Link to Related Resource 5',\n    sheetId: 'linkurl5'\n  },\n  LINKTITLE5: {\n    displayName: 'Link title 5',\n    sheetId: 'linktitle5'\n  },\n  LINKURL6: {\n    displayName: 'Link to Related Resource 6',\n    sheetId: 'linkurl6'\n  },\n  LINKTITLE6: {\n    displayName: 'Link title 6',\n    sheetId: 'linktitle6'\n  }\n};\n\nconst LINK_FIELD_PAIRS = [\n  { urlField: SHEET_FIELDS.LINKURL1, titleField: SHEET_FIELDS.LINKTITLE1 },\n  { urlField: SHEET_FIELDS.LINKURL2, titleField: SHEET_FIELDS.LINKTITLE2 },\n  { urlField: SHEET_FIELDS.LINKURL3, titleField: SHEET_FIELDS.LINKTITLE3 },\n  { urlField: SHEET_FIELDS.LINKURL4, titleField: SHEET_FIELDS.LINKTITLE4 },\n  { urlField: SHEET_FIELDS.LINKURL5, titleField: SHEET_FIELDS.LINKTITLE5 },\n  { urlField: SHEET_FIELDS.LINKURL6, titleField: SHEET_FIELDS.LINKTITLE6 },\n];\n\nconst FEATURE_HEADERS = {\n  ORGANIZATIONAL: {\n    displayName: 'ORGANIZATIONAL FEATURES',\n    sheetId: null,\n    isFeatureHeader: true\n  },\n  IMPLEMENTATION: {\n    displayName: 'IMPLEMENTATION FEATURES',\n    sheetId: null,\n    isFeatureHeader: true\n  },\n};\n\nconst COMPOSITE_FIELDS = {\n  RELATED_RESOURCES: {\n    displayName: 'Links to Related Resources',\n    sheetId: null,\n    isExpandible: true,\n    // composite: true\n  }\n};\n\nconst ORDERED_CARD_FIELDS = [\n  // SHEET_FIELDS.LONGITUDE,\n  // SHEET_FIELDS.LATITUDE,\n  // SHEET_FIELDS.EID,\n  // SHEET_FIELDS.NAME,\n  // SHEET_FIELDS.TYPE,\n  SHEET_FIELDS.LOCATION,\n  SHEET_FIELDS.DATES,\n  SHEET_FIELDS.RECIPIENTS,\n  FEATURE_HEADERS.ORGANIZATIONAL,\n  SHEET_FIELDS.IMPLEMENTER,\n  SHEET_FIELDS.RESEARCHER,\n  SHEET_FIELDS.FUNDER,\n  FEATURE_HEADERS.IMPLEMENTATION,\n  SHEET_FIELDS.TARGETING,\n  SHEET_FIELDS.UNIT,\n  SHEET_FIELDS.AMOUNT,\n  SHEET_FIELDS.FREQUENCY,\n  SHEET_FIELDS.EVALUATION,\n  SHEET_FIELDS.NOTES,\n  SHEET_FIELDS.WEBSITE,\n  COMPOSITE_FIELDS.RELATED_RESOURCES\n  // SHEET_FIELDS.LINKURL1,\n  // SHEET_FIELDS.LINKTITLE1,\n  // SHEET_FIELDS.LINKURL2,\n  // SHEET_FIELDS.LINKTITLE2,\n  // SHEET_FIELDS.LINKURL3,\n  // SHEET_FIELDS.LINKTITLE3,\n  // SHEET_FIELDS.LINKURL4,\n  // SHEET_FIELDS.LINKTITLE4,\n  // SHEET_FIELDS.LINKURL5,\n  // SHEET_FIELDS.LINKTITLE5,\n  // SHEET_FIELDS.LINKURL6,\n  // SHEET_FIELDS.LINKTITLE6\n];\n\nexport { SHEET_FIELDS, FEATURE_HEADERS, COMPOSITE_FIELDS, ORDERED_CARD_FIELDS, LINK_FIELD_PAIRS };","import React from 'react';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\n\nclass UserHint extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let classes = 'user-hint';\n    if (this.props.classes) {\n      classes += ` ${this.props.classes}`;\n    }\n    if (this.props.dismissed) {\n      classes += ' dismissed';\n    }\n    \n    return (\n      <div className={classes}>\n        <div className='content'>{this.props.content}</div>\n      </div>\n    )\n  }\n}\n\nexport default UserHint;\n","import React from 'react';\nimport _ from 'lodash';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\nimport { SHEET_FIELDS, ORDERED_CARD_FIELDS, COMPOSITE_FIELDS, LINK_FIELD_PAIRS } from './fields';\nimport UserHint from './UserHint';\n\nconst { LOCATION, NAME, EID, TYPE, WEBSITE } = SHEET_FIELDS;\n\n// pure component? (shallow compare map features?) (perf)\nclass CardDock extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      minimized: true,\n      expandedProperties: {},\n      scrollHintDismissed: false    \n    };\n\n    this.removeCard = this.removeCard.bind(this);\n    this.slideDock = this.slideDock.bind(this);\n    this.toggleDock = this.toggleDock.bind(this);\n    this.maximizeDock = this.maximizeDock.bind(this);\n    this.toggleProperty = this.toggleProperty.bind(this);\n  }\n\n  removeCard(id) {\n    this.props.removeCard(id);\n  }\n\n  slideDock(e) {\n    if (e.deltaY && e.deltaY > 0) {\n      this.setState({ minimized: false, scrollHintDismissed: true });\n    }\n  }\n\n  toggleDock() {\n    // TODO: call toggle? or remove, make only scroll-controlled\n    this.setState(state => ({ minimized: !this.state.minimized }));\n  }\n\n  maximizeDock() {\n    // TODO: call toggle? or remove, make only scroll-controlled\n    this.setState(state => ({ minimized: false }));\n  }\n\n  toggleProperty(property, expanded) {\n    const expandedProperties = {...this.state.expandedProperties};\n    expandedProperties[property] = !expanded;\n    this.setState({ expandedProperties });\n  }\n\n  getNames() {\n    // TODO: don't bind in render (perf)\n    return this.props.cardData.map(experimentCardSet => {\n      const {\n        [EID.sheetId]: eid,\n        [NAME.sheetId]: name,\n        [TYPE.sheetId]: type\n      } = experimentCardSet[0];\n      const classes = 'name ' + type;\n      return (\n        <td key={'name'+eid} className={classes}>\n          {name||'(none)'}\n          <TriggerIcon iconType={ICON_TYPE.REMOVE} onClick={this.removeCard.bind(this, eid)} />\n        </td>\n    )});\n  }\n\n  getRows() {\n    return ORDERED_CARD_FIELDS.map(field => {\n      const { displayName, sheetId, isFeatureHeader } = field;\n\n      const expandible = this.getIsExpandible(field);\n\n      const expanded = !!this.state.expandedProperties[field.sheetId];\n\n      let expandIcon = null;\n      if (expandible) {\n        // TODO: also don't bind in render (perf)\n        const iconType = expanded ? ICON_TYPE.COLLAPSE : ICON_TYPE.EXPAND;\n        expandIcon = (\n          <TriggerIcon\n            onClick={this.toggleProperty.bind(this, field.sheetId, expanded)}\n            iconType={iconType}\n          />\n        );\n      }\n\n      let cellClass = 'property-cell';\n      if (expandible) {\n        cellClass += ' expandible';\n      }\n      if (isFeatureHeader) {\n        cellClass += ' feature-header';\n      }\n\n      let valueClass = 'property-value';\n      if (expanded) {\n        valueClass += ' expanded';\n      }\n\n      const propertyCells = this.props.cardData.map(experimentCardSet => {\n\n        const cellContent = this.getCellContent(experimentCardSet, field);\n        const { [EID.sheetId]: eid } = experimentCardSet[0];\n        return (\n          <td className={cellClass} key={displayName+'-td-'+eid}>\n            <div className='property-name'>{displayName}{expandIcon}</div>\n            <div className={valueClass}>{cellContent}</div>\n          </td>\n      )});\n      return <tr className='property-row' key={displayName}>{propertyCells}</tr>;\n    });\n  }\n\n  getIsExpandible(field) {\n    // 1) not expandible => F 2) has multiple locations w/diff values => T 3) sole value > 40Ms\n    if (field === LOCATION) {\n      // if any experimint in the card dock has multiple locations, the cell should be expandible\n      return _.some(this.props.cardData, expCardSet => expCardSet.length > 1);\n    }\n    return field.isExpandible;\n  }\n\n  getCellContent(experimentCardSet, field) {\n    if (field === LOCATION) {\n      return this.getLocationCellContent(experimentCardSet);\n    } else if (field.isFeatureHeader) {\n      return null;\n    } else if (field === COMPOSITE_FIELDS.RELATED_RESOURCES) {\n      return this.getLinksContent(experimentCardSet);\n    }\n\n    const { sheetId } = field;\n    const [locationOneData, ...otherLocationsData] = experimentCardSet;\n    const firstValue = locationOneData[sheetId];\n    const uniformValue = field.forceUniformValue || _.every(otherLocationsData, l => l[sheetId] === firstValue);\n\n    let cellContent;\n    if (field === WEBSITE && firstValue.includes('.')) {\n      cellContent = <a href={firstValue} target=\"_blank\">{firstValue}</a>;\n    } else if (uniformValue) {\n      cellContent = firstValue;\n    } else {\n      // break cell into block for each location, as they have different values\n      cellContent = experimentCardSet.map(locationData => {\n        const {\n          [EID.sheetId]: eid,\n          [LOCATION.sheetId]: location,\n        } = locationData;\n        return (\n          <div key={`cell-content-${sheetId}-${eid}-${location}`}>\n            <div\n              title={location}\n              className='property-location-title'\n            >\n              {location}\n            </div>\n            {locationData[sheetId]}\n          </div>\n        )\n      })\n    }\n\n    return <>{cellContent}</>;\n  }\n\n  getLocationCellContent(experimentCardSet) {\n    const cellContent = experimentCardSet.map(locationData => {\n      const {\n        [EID.sheetId]: eid,\n        [LOCATION.sheetId]: location,\n      } = locationData;\n      return (\n        <div\n          title={location}\n          className='location-cell-content'\n          key={`cell-content-location-${eid}-${location}`}\n        >\n          {location}\n        </div>\n    )});\n    return <>{cellContent}</>;\n  }\n\n  getLinksContent(experimentCardSet) {\n    const linkMap = {};\n    const orderedLinks = [];\n    experimentCardSet.forEach(locationData => {\n      LINK_FIELD_PAIRS.forEach(({ urlField, titleField }) => {\n        const urlValue = locationData[urlField.sheetId];\n        if (urlValue && !linkMap[urlValue]) {\n          linkMap[urlValue] = true;\n          const titleValue = locationData[titleField.sheetId] || urlValue;\n          orderedLinks.push({ urlValue, titleValue });\n        }\n      })\n    });\n\n    return (\n      <div\n        key={`cell-content-links-${experimentCardSet[0][EID.sheetId]}`}\n      >\n        {orderedLinks.map(({ urlValue, titleValue }) => (\n          <a key={urlValue} href={urlValue} target=\"_blank\">{titleValue}</a>\n        ))}\n      </div>\n    );\n  }\n\n  getScrollHint() {\n    const content = (\n    <>scroll for more {<TriggerIcon iconType={ICON_TYPE.D_ARROW} />}</>\n    );\n    return (\n      <UserHint\n        content={content}\n        classes={'scroll-hint'}\n        dismissed={this.state.scrollHintDismissed}\n      />\n    );\n  }\n\n  getSelectionHint() {\n    const content = (\n    <>\n      click more map points to compare experiments<p className='maximum'>(max. 3)</p>\n      <TriggerIcon iconType={ICON_TYPE.R_ARROW} />\n    </>\n    );\n\n    let classes = 'selection-hint ';\n\n    if (this.state.scrollHintDismissed) {\n      classes += 'sole-hint';\n    }\n    return (\n      <UserHint\n        content={content}\n        classes={classes}\n        dismissed={this.props.selectionHintDismissed}\n      />\n    );\n  }\n\n  render() {\n    if (!this.props.cardData.length) {\n      return null;\n    }\n\n    let classes = 'card-dock-container ';\n    classes += `card-count-${this.props.cardData.length}`;\n    if (!this.state.minimized) {\n      classes += ' maximized';\n    }\n\n    return (\n      <div\n        onWheel={this.slideDock}\n        onDoubleClick={this.toggleDock}\n        onTouchStart={this.maximizeDock}\n        className={'card-dock-wrapper'}\n      >\n        <div className={classes}>\n          {this.getScrollHint()}\n          {this.getSelectionHint()}\n          <table className=\"card-dock\">\n            <thead>\n              <tr>{this.getNames()}</tr>\n            </thead>\n            <tbody>\n              {this.getRows()}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default CardDock;\n","import React from 'react';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\n\nclass Legend extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { expanded: true };\n\n    this.toggleExpand = this.toggleExpand.bind(this);\n  }\n\n  toggleExpand() {\n    this.setState(state => ({ expanded: !state.expanded }));\n  }\n\n  render() {\n    let classes = 'legend';\n    if (!this.state.expanded) {\n      classes += ' hidden';\n    }\n\n    const iconType = this.state.expanded ? ICON_TYPE.COLLAPSE : ICON_TYPE.EXPAND;\n    return (\n      <div className={classes}>\n          <TriggerIcon onClick={this.toggleExpand} inBrackets={true} iconType={iconType} />\n          <div className='content'>\n            <div><i className='past' />Past Experiments</div>\n            <div><i className='ongoing' />Ongoing Experiments</div>\n            <div><i className='proposed' />Proposed Experiments</div>\n          </div>\n      </div>\n    )\n  }\n}\n\nexport default Legend;\n","import React from 'react';\n\nconst POINT_BUFFER = 7;\n\nclass Tooltip extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      left: 0,\n      top: 0,\n      adjusted: false\n    };\n\n    this.ref = React.createRef();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const { expId } = nextProps;\n    if (this.props.expId === expId || !expId) {\n      // if we're still hovering the same point, don't worry about updating\n      return;\n    }\n\n    // The following steps insure a tooltip doesn't flow outside of the window bounds:\n    // 1] when we hover a new point, we initially render without adjusting the tooltip location\n    this.setState({ \n      adjusted: false,\n      left: nextProps.x,\n      top: nextProps.y\n    });\n  }\n\n  componentDidUpdate() {\n    if (this.state.adjusted || !this.props.expId) {\n      // 6] location has already been adjusted, so don't trigger a rerender\n      return;\n    }\n\n    this.adjustPosition();\n  }\n\n  adjustPosition() {\n    // 3] after the initial render, we have access to the tooltip's DOM node and can tell it's size\n    const { width: tooltipWidth, height: tooltipHeight } = this.ref.current.getBoundingClientRect();\n    const windowElement = document.getElementById('root');\n    const { width: windowWidth, height: windowHeight } = windowElement.getBoundingClientRect();\n    \n    let { left, top } = this.state;\n    // by default, tooltip appears above the point\n    top -= (tooltipHeight + POINT_BUFFER);\n    if (top < 0) {\n      // if it would run off the top of the screen, shift it below the point\n      top += tooltipHeight + POINT_BUFFER*2;\n\n      if ((top + tooltipHeight) > windowHeight) {\n        // ...unless it would then run off the bottom, in which case set it as high as possible\n        top = 1;\n      }\n    }\n\n    left += POINT_BUFFER;\n    if (left + tooltipWidth > windowWidth) {\n      // if the tooltip would run off the right of the screen, shift it left of the point\n      left -= (tooltipWidth + POINT_BUFFER*2);\n\n      if (left < 0) {\n        // ...unless it would then run off the left, in which case set it up against the right border\n        left = windowWidth - (tooltipWidth + 2);\n      }\n    }\n\n    // 4] record our adjusted coordinates, which will trigger a rerender\n    this.setState({ left, top, adjusted: true });\n  }\n  \n  getLocations() {\n    const { location, otherLocations } = this.props;\n    let hoveredClass = 'hovered-location';\n    let otherLocationElements = null;\n\n    if (otherLocations.length) {\n      hoveredClass += ' emphasized';\n      otherLocationElements = otherLocations.map(l => <p key={l}>{l}</p>);\n    }\n\n    return (\n      <>\n        <p className={hoveredClass}>{location}</p>\n        {otherLocationElements}\n      </>\n    )\n  }\n\n  render() {\n    const { expId, name, type } = this.props;\n    if (!expId) {\n      return null;\n    }\n\n    let style = {};\n    if (!this.state.adjusted) {\n      // 2] hide this initial render so user doesn't see tooltip \"jump\"\n      style = { visibility: 'hidden', left: '0px', top: '0px' };\n    } else {\n      // 5] finally, our tooltip can be told where to properly render\n      style = { left: this.state.left + 'px', top: this.state.top + 'px' };\n    }\n\n    const classes = 'tooltip ' + type;\n    return (\n      <div className={classes} style={style} ref={this.ref}>\n        <div className='name'>{name||'(none)'}</div>\n        <div className='detail'>\n          <p className='location-title'>Location:</p>\n          {this.getLocations()}\n        </div>\n        <p className='click-hint'>click point for more info</p>\n      </div>\n    )\n  }\n}\n\nexport default Tooltip;\n","import CardDock from './CardDock';\nimport Legend from './Legend';\nimport React from 'react';\nimport Tooltip from './Tooltip';\nimport mapboxgl from 'mapbox-gl';\nimport _ from 'lodash';\nimport styleData from './style.json';\nimport './App.css';\nimport { SHEET_FIELDS } from './fields';\n\nconst { LONGITUDE, LATITUDE, NAME, LOCATION, TYPE, EID } = SHEET_FIELDS;\n\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN;\nconst MAX_SELECTED_POINTS = 3;\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lat: 40.66995747013945,\n      lng: -103.59179687498357,\n      zoom: 3,\n      hovered: {},\n      selectedIds: [],\n      isTouchScreen: false,\n      selectionHintDismissed: false\n    };\n\n    this.map = null;\n    this.getCardDock = this.getCardDock.bind(this);\n    this.getTooltip = this.getTooltip.bind(this);\n    this.removeCard = this.removeCard.bind(this);\n    this.getFeaturesByExperimentId = this.getFeaturesByExperimentId.bind(this);\n  }\n\n  componentDidMount() {\n    this.map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: styleData,\n      center: [this.state.lng, this.state.lat],\n      zoom: this.state.zoom,\n    });\n    \n    this.map.on('move', () => {\n      this.featuresOnUnhover();\n      console.log('lat: ', this.map.getCenter().lat.toFixed(4));\n      console.log('lng: ', this.map.getCenter().lng.toFixed(4));\n      console.log('zoom: ', this.map.getZoom().toFixed(2));\n      this.setState({\n        lng: this.map.getCenter().lng.toFixed(4),\n        lat: this.map.getCenter().lat.toFixed(4),\n        zoom: this.map.getZoom().toFixed(2)\n      });\n    });\n    \n    this.map.on('click', 'experimentSites', this.featuresOnClick.bind(this));\n    this.map.on('mouseenter', 'experimentSites', this.featuresOnHover.bind(this));\n    this.map.on('mouseleave', 'experimentSites', this.featuresOnUnhover.bind(this));\n\n    this.map.on('touchstart', 'experimentSites', this.touchstart.bind(this));\n    \n    load.call(this); \n  }\n  \n  touchstart(e) {\n    this.setState({ isTouchScreen: true });\n  }\n\n  getFeaturesByExperimentId(expId) {\n    const { features } = this.map.getSource('experiments')._data;\n    return features.filter(f => f.id === expId).map(f => f.properties);\n  }\n  \n  featuresOnClick(e) {\n    const { id: expId } = e.features[0];\n    const selectedIds = [...this.state.selectedIds];\n    const idx = selectedIds.indexOf(expId);\n    const alreadySelected = idx > -1;\n\n    if (!alreadySelected) {\n      if (selectedIds.length >= MAX_SELECTED_POINTS) {\n        console.log('OH SHET!');\n        // warn user\n        return;\n      } else {\n        selectedIds.push(expId);\n      }\n    } else {\n      selectedIds.splice(idx, 1);\n    }\n\n    // dismiss selection hint once multiple points have been selected\n    const selectionHintDismissed = (selectedIds.length > 1) || this.state.selectionHintDismissed;\n    this.setState({ selectedIds, selectionHintDismissed });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { selected: !alreadySelected }\n    );\n  }\n\n  featuresOnHover(e) {\n    if (this.state.isTouchScreen) {\n      // devices with touch screens shouldn't have tooltips\n      return;\n    }\n    this.map.getCanvas().style.cursor = 'pointer';\n    const { id: expId, properties } = e.features[0];    \n    const { x, y } = e.point;\n\n    this.setState({ \n      hovered: {\n        name: properties[NAME.sheetId],\n        location: properties[LOCATION.sheetId],\n        type: properties[TYPE.sheetId],\n        expId,\n        x,\n        y \n      }\n    });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { hover: true }\n    );\n  }\n\n  featuresOnUnhover() {\n    if (this.state.isTouchScreen || !this.state.hovered.expId) {\n      return;\n    }\n    this.map.getCanvas().style.cursor = '';\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: this.state.hovered.expId\n      }, { hover: false }\n    );\n\n    this.setState({ hovered: {} });\n  }\n\n  removeCard(expId) {\n    const selectedIds = [...this.state.selectedIds];\n    const idx = selectedIds.indexOf(expId);\n    selectedIds.splice(idx, 1);\n\n    this.setState({ selectedIds });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { selected: false }\n    );\n  }\n\n  getTooltip() {\n    const { expId, name, location, type, x, y } = this.state.hovered;\n    let otherLocations = [];\n    if (expId) {\n      const features = this.getFeaturesByExperimentId(expId);\n      otherLocations = features\n        .map(f => f.location)\n        .filter(l => l !== location);\n    }\n    return <Tooltip expId={expId} name={name} location={location} otherLocations={otherLocations} type={type} x={x} y={y}/>;\n  }\n\n  getCardDock() {\n    if (!this.map) {\n      return null;\n    }\n\n    const { selectedIds, isTouchScreen, selectionHintDismissed } = this.state;\n    const cardData = selectedIds.map(this.getFeaturesByExperimentId);\n    return (\n      <CardDock\n        removeCard={this.removeCard}\n        cardData={cardData}\n        isTouchScreen={isTouchScreen}\n        selectionHintDismissed={selectionHintDismissed}\n      />\n    );\n  }\n  \n  render() {\n    return (\n      <div className='app'>\n        {this.getCardDock()}\n        {this.getTooltip()}\n        <div ref={el => this.mapContainer = el} className='map-container' />\n        <Legend />\n      </div>\n    );\n  }\n}\n\nlet nextEidNumber = 1;\nconst eidMap = {};\n\nfunction load () {\n  // startsWith polyfill\n  if (!String.prototype.startsWith) {\n    Object.defineProperty(String.prototype, 'startsWith', {\n        value: function(search, rawPos) {\n            const pos = rawPos > 0 ? rawPos|0 : 0;\n            return this.substring(pos, pos + search.length) === search;\n        }\n    });\n  }\n\n  const experimentsData = { type: 'FeatureCollection', features: [] };\n\n  const reqHandler = (source, req) => {\n    const [ columnHeaderRow, ...rows ] = JSON.parse(req.responseText).feed.entry;\n    const properties = Object.keys(rows[0])\n      .filter(function (p) { \n        return p.startsWith('gsx$') & !p.endsWith('_db1zf');\n      })\n      .map(function (p) { return p.substr(4); });\n    \n    const items = rows.map(function (r, ri) {\n      const row = {};\n      properties.forEach(function (p) {\n        row[p] = r['gsx$' + p].$t === '' ? null : r['gsx$' + p].$t;\n        if ([LATITUDE.sheetId, LONGITUDE.sheetId].indexOf(p) !== -1) {\n          // mapbox wants numeric lat/long\n          row[p] = +row[p];\n        }\n        if (p === EID.sheetId) {\n          // convert the string eids from the sheet into numeric ids (which mapbox expects)\n          const stringEid = row[p];\n          const numericEid = eidMap[stringEid] || nextEidNumber++;\n          eidMap[stringEid] = numericEid;\n          row[p] = numericEid;\n        }\n        if (p === TYPE.sheetId) {\n          // force lower case to simplify equality comparisons\n          row[p] = row[p].toLowerCase();\n        }\n        if (row[p] === null) {\n          row[p] = '';\n        }\n      });\n      return {\n        type: 'Feature',\n        id: row[EID.sheetId],\n        geometry: {\n          type: 'Point',\n          coordinates: [row[LATITUDE.sheetId], row[LONGITUDE.sheetId]]\n        },\n        properties: row\n      };\n    });\n    \n    experimentsData.features.push(...items);\n    this.map.getSource('experiments').setData(experimentsData);\n  }\n\n  // Fetch Local Article Data\n  const experimentsReq = new XMLHttpRequest();\n  experimentsReq.addEventListener('load',  () => { reqHandler('experiments', experimentsReq) });\n  console.log(process.env.REACT_APP_SHEET_URL);\n  experimentsReq.open('GET', process.env.REACT_APP_SHEET_URL);\n  experimentsReq.send();\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}