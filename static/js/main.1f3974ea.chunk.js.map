{"version":3,"sources":["TriggerIcon.js","fields.js","UserHint.js","CardDock.js","IntroPanel.js","Legend.js","LoadingMask.js","Tooltip.js","App.js","index.js"],"names":["ICON_TYPE","REMOVE","EXPAND","COLLAPSE","D_ARROW","D_ARROW_STEMLESS","R_ARROW","L_ARROW","L_ARROW_STEMLESS","INFO_ICON","TriggerIcon","props","this","onClick","x1","x2","y1","y2","stemless","points","d","fill-rule","fill","icon","classes","transform","viewBox","iconType","getRemove","getExpand","getCollapse","getDownArrow","D_ARROW_STL_ARROW_STEMLESS","getInfoIcon","console","error","inBrackets","getBracketWrap","className","title","React","Component","SHEET_FIELDS","LONGITUDE","displayName","sheetId","LATITUDE","EID","NAME","TYPE","LOCATION","DATES","RECIPIENTS","IMPLEMENTER","RESEARCHER","FUNDER","TARGETING","UNIT","AMOUNT","FREQUENCY","EVALUATION","NOTES","WEBSITE","forceUniformValue","LINKURL1","LINKTITLE1","LINKURL2","LINKTITLE2","LINKURL3","LINKTITLE3","LINKURL4","LINKTITLE4","LINKURL5","LINKTITLE5","LINKURL6","LINKTITLE6","LINK_FIELD_PAIRS","urlField","titleField","FEATURE_HEADERS","ORGANIZATIONAL","isFeatureHeader","IMPLEMENTATION","COMPOSITE_FIELDS","RELATED_RESOURCES","isComposite","ORDERED_CARD_FIELDS","UserHint","dismissed","dismissTrigger","onDismiss","content","CardDock","containerRef","createRef","state","scrollHintDismissed","maxPointHintDismissed","mapMaskActive","removeCard","bind","updateMask","throttledUpdateMask","_","throttle","leading","trailing","dismissMaxPointHint","newProps","cardData","length","maxCardHintTriggered","setState","setTimeout","id","e","deltaY","top","current","getBoundingClientRect","window","innerHeight","map","experimentCardSet","idx","eid","name","type","key","field","cellClass","cells","getCellContent","locationOneData","otherLocationsData","firstValue","some","l","getLocationCellContent","getLinksContent","includes","href","target","getIsDifferentiated","locationData","location","cellContent","linkMap","orderedLinks","forEach","urlValue","titleValue","push","selectionHintDismissed","maskClass","onWheel","onTouchMove","ref","getScrollHint","getSelectionHint","getMaxPointHint","getNames","getRows","PureComponent","IntroPanel","open","toggleOpen","Legend","expanded","toggleExpand","LoadingMask","dataLoaded","mapLoaded","mapConfigured","Tooltip","left","adjusted","nextProps","expId","x","y","adjustPosition","tooltipWidth","width","tooltipHeight","height","document","getElementById","windowWidth","windowHeight","POINT_BUFFER","otherLocations","hoveredClass","otherLocationElements","style","visibility","getLocations","mapboxgl","accessToken","process","App","isTouchScreen","hovered","selectedIds","mapContainer","getCardDock","getTooltip","getFeaturesByExperimentId","Map","container","styleData","center","zoom","maxBounds","addControl","NavigationControl","dragRotate","disable","touchZoomRotate","disableRotation","on","markMapLoaded","debounce","featuresOnUnhover","log","getCenter","lat","toFixed","lng","getZoom","featuresOnClick","featuresOnHover","registerTouchScreen","load","call","getSource","_data","features","filter","f","properties","indexOf","alreadySelected","splice","setFeatureState","source","selected","getCanvas","cursor","point","hover","nextEidNumber","eidMap","String","prototype","startsWith","Object","defineProperty","value","search","rawPos","pos","substring","experimentsData","experimentsReq","XMLHttpRequest","addEventListener","req","JSON","parse","responseText","feed","entry","rows","keys","p","endsWith","substr","items","r","ri","row","$t","stringEid","numericEid","toLowerCase","geometry","coordinates","setData","reqHandler","send","ReactDOM","render"],"mappings":"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","file":"static/js/main.1f3974ea.chunk.js","sourcesContent":["import React from 'react';\n\nconst ICON_TYPE = {\n  REMOVE: 'remove',\n  EXPAND: 'expand',\n  COLLAPSE: 'collapse',\n  D_ARROW: 'down-arrow',\n  D_ARROW_STEMLESS: 'down-arrow-stemless',\n  R_ARROW: 'right-arrow',\n  L_ARROW: 'left-arrow',\n  L_ARROW_STEMLESS: 'left-arrow-stemless',\n  INFO_ICON: 'info-icon'\n};\n\nclass TriggerIcon extends React.Component {\n  constructor(props) {\n    super(props)\n  }\n\n  onClick() {\n    this.props.onClick();\n  }\n\n  getRemove() {\n    return (\n      <>\n        <line x1='15' x2='85' y1='15' y2='85'/>\n        <line x1='15' x2='85' y1='85' y2='15'/>\n      </>\n    )    \n  }\n  \n  getExpand() {\n    return (\n      <>\n        <line x1='15' x2='85' y1='50' y2='50'/>\n        <line x1='50' x2='50' y1='15' y2='85'/>\n      </>\n    )    \n  }\n\n  getCollapse() {\n    return (\n      <>\n        <line x1='20' x2='80' y1='50' y2='50'/>\n      </>\n    )    \n  }\n\n  getDownArrow(stemless) {\n    return (\n      <>\n        {!stemless && <polyline points='50,0 50,100' />}\n        <polyline points='10,55 50,100 90,55' />\n      </>\n    )\n  }\n\n  getInfoIcon() {\n    return (\n      <>\n        <path d=\"m128 22.158a105.84 105.84 0 0 0 -105.84 105.84 105.84 105.84 0 0 0 105.84 105.84 105.84 105.84 0 0 0 105.84 -105.84 105.84 105.84 0 0 0 -105.84 -105.84zm0 32.76c5.16 0.117 9.55 1.875 13.18 5.273 3.34 3.575 5.07 7.94 5.19 13.096-0.12 5.156-1.85 9.404-5.19 12.744-3.63 3.75-8.02 5.625-13.18 5.625s-9.4-1.875-12.74-5.625c-3.75-3.34-5.63-7.588-5.63-12.744s1.88-9.521 5.63-13.096c3.34-3.398 7.58-5.156 12.74-5.273zm-16.35 53.792h32.79v92.37h-32.79v-92.37z\" fill-rule=\"evenodd\" fill=\"#72a7cf\"/>\n      </>\n    )\n  }\n  \n  getBracketWrap(icon) {\n    return (\n      <>\n        <polyline points='15,0 0,0 0,100 15,100' />\n          {icon}\n        <polyline points='85,0 100,0 100,100 85,100' />\n      </>\n    )    \n  }\n  \n  render() {\n    let icon;\n    let classes = 'trigger-icon ';\n    let transform = '';\n    let viewBox = '0 0 100 100';\n    switch (this.props.iconType) {\n      case ICON_TYPE.REMOVE:\n        icon = this.getRemove();\n        classes += 'remove-icon';\n        break;\n      case ICON_TYPE.EXPAND:\n        icon = this.getExpand();\n        classes += 'expand-icon';\n        break;\n      case ICON_TYPE.COLLAPSE:\n        icon = this.getCollapse();\n        classes += 'collapse-icon';\n        break;\n      case ICON_TYPE.D_ARROW:\n        icon = this.getDownArrow();\n        classes += 'down-arrow';\n        break;\n      case ICON_TYPE.D_ARROW_STL_ARROW_STEMLESS:\n        icon = this.getDownArrow(true);\n        classes += 'down-arrow stemless';\n        break;\n      case ICON_TYPE.R_ARROW:\n        icon = this.getDownArrow();\n        classes += 'right-arrow';\n        transform += 'rotate(270)';\n        break;\n      case ICON_TYPE.L_ARROW:\n        icon = this.getDownArrow();\n        classes += 'left-arrow';\n        transform += 'rotate(90)';\n        break;\n      case ICON_TYPE.L_ARROW_STEMLESS:\n        icon = this.getDownArrow(true);\n        classes += 'left-arrow stemless';\n        transform += 'rotate(90)';\n        break;\n      case ICON_TYPE.INFO_ICON:\n        icon = this.getInfoIcon();\n        classes += 'info-icon';\n        viewBox = '0 0 256 256'\n        break;\n      default:\n        console.error('incorrect type');\n    }\n\n    if (this.props.inBrackets) {\n      classes += ' bracketed';\n      icon = this.getBracketWrap(icon);\n    }\n\n    return (\n        <svg\n          onClick={this.props.onClick}\n          viewBox={viewBox}\n          transform={transform}\n          className={classes}\n        >\n          {this.props.title && <title>{this.props.title}</title>}\n          {icon}\n        </svg>\n    )\n  }\n}\n\nexport default TriggerIcon;\nexport { ICON_TYPE };\n","const SHEET_FIELDS = {\n  LONGITUDE: {\n    displayName: 'Longitude', // how the field will appear on the card\n    sheetId: 'longitude' // corresponds to the column header on the google sheet\n  },\n  LATITUDE: {\n    displayName: 'Latitude',\n    sheetId: 'latitude'\n  },\n  // NOTE: Used to bind the different locations of a given experiment together.\n  // We use it as the mapbox ID for the feature to simplify unified hover/selection styling.\n  EID: {\n    displayName: 'Experiment ID',\n    sheetId: 'eid'\n  },\n  NAME: {\n    displayName: 'Name of Experiment',\n    sheetId: 'name'\n  },\n  TYPE: {\n    displayName: 'Past, Ongoing, Proposed',\n    sheetId: 'type'\n  },\n  LOCATION: {\n    displayName: 'Location',\n    sheetId: 'location'\n  },\n  DATES: {\n    displayName: 'Implementation Dates',\n    sheetId: 'dates'\n  },\n  RECIPIENTS: {\n    displayName: 'Number of Recipients',\n    sheetId: 'recipients'\n  },\n  IMPLEMENTER: {\n    displayName: 'Implementing Agency',\n    sheetId: 'implementer',\n    // isExpandible: true\n  },\n  RESEARCHER: {\n    displayName: 'Research Agency',\n    sheetId: 'researcher',\n    // isExpandible: true\n  },\n  FUNDER: {\n    displayName: 'Funding Agency',\n    sheetId: 'funder',\n    // isExpandible: true\n  },\n  TARGETING: {\n    displayName: 'Type of Targeting',\n    sheetId: 'targeting',\n    // isExpandible: true\n  },\n  UNIT: {\n    displayName: 'Unit of Recipient',\n    sheetId: 'unit'\n  },\n  AMOUNT: {\n    displayName: 'Amount of Transfer',\n    sheetId: 'amount',\n    // isExpandible: true\n  },\n  FREQUENCY: {\n    displayName: 'Frequency of Payment',\n    sheetId: 'frequency'\n  },\n  EVALUATION: {\n    displayName: 'Method of Evaluation',\n    sheetId: 'evaluation'\n  },\n  NOTES: {\n    displayName: 'Additional Notes of Interest',\n    sheetId: 'notes',\n    // isExpandible: true\n  },\n  WEBSITE: {\n    displayName: 'Link to Website',\n    sheetId: 'website',\n    forceUniformValue: true\n  },\n  LINKURL1: {\n    displayName: 'Link to Related Resource 1',\n    sheetId: 'linkurl1'\n  },\n  LINKTITLE1: {\n    displayName: 'Link title 1',\n    sheetId: 'linktitle1'\n  },\n  LINKURL2: {\n    displayName: 'Link to Related Resource 2',\n    sheetId: 'linkurl2'\n  },\n  LINKTITLE2: {\n    displayName: 'Link title 2',\n    sheetId: 'linktitle2'\n  },\n  LINKURL3: {\n    displayName: 'Link to Related Resource 3',\n    sheetId: 'linkurl3'\n  },\n  LINKTITLE3: {\n    displayName: 'Link title 3',\n    sheetId: 'linktitle3'\n  },\n  LINKURL4: {\n    displayName: 'Link to Related Resource 4',\n    sheetId: 'linkurl4'\n  },\n  LINKTITLE4: {\n    displayName: 'Link title 4',\n    sheetId: 'linktitle4'\n  },\n  LINKURL5: {\n    displayName: 'Link to Related Resource 5',\n    sheetId: 'linkurl5'\n  },\n  LINKTITLE5: {\n    displayName: 'Link title 5',\n    sheetId: 'linktitle5'\n  },\n  LINKURL6: {\n    displayName: 'Link to Related Resource 6',\n    sheetId: 'linkurl6'\n  },\n  LINKTITLE6: {\n    displayName: 'Link title 6',\n    sheetId: 'linktitle6'\n  }\n};\n\nconst LINK_FIELD_PAIRS = [\n  { urlField: SHEET_FIELDS.LINKURL1, titleField: SHEET_FIELDS.LINKTITLE1 },\n  { urlField: SHEET_FIELDS.LINKURL2, titleField: SHEET_FIELDS.LINKTITLE2 },\n  { urlField: SHEET_FIELDS.LINKURL3, titleField: SHEET_FIELDS.LINKTITLE3 },\n  { urlField: SHEET_FIELDS.LINKURL4, titleField: SHEET_FIELDS.LINKTITLE4 },\n  { urlField: SHEET_FIELDS.LINKURL5, titleField: SHEET_FIELDS.LINKTITLE5 },\n  { urlField: SHEET_FIELDS.LINKURL6, titleField: SHEET_FIELDS.LINKTITLE6 },\n];\n\nconst FEATURE_HEADERS = {\n  ORGANIZATIONAL: {\n    displayName: 'ORGANIZATIONAL FEATURES',\n    sheetId: null,\n    isFeatureHeader: true\n  },\n  IMPLEMENTATION: {\n    displayName: 'IMPLEMENTATION FEATURES',\n    sheetId: null,\n    isFeatureHeader: true\n  },\n};\n\nconst COMPOSITE_FIELDS = {\n  RELATED_RESOURCES: {\n    displayName: 'Links to Related Resources',\n    sheetId: null,\n    // isExpandible: true,\n    isComposite: true\n  }\n};\n\nconst ORDERED_CARD_FIELDS = [\n  // SHEET_FIELDS.LONGITUDE,\n  // SHEET_FIELDS.LATITUDE,\n  // SHEET_FIELDS.EID,\n  // SHEET_FIELDS.NAME,\n  // SHEET_FIELDS.TYPE,\n  SHEET_FIELDS.LOCATION,\n  SHEET_FIELDS.DATES,\n  SHEET_FIELDS.RECIPIENTS,\n  FEATURE_HEADERS.ORGANIZATIONAL,\n  SHEET_FIELDS.IMPLEMENTER,\n  SHEET_FIELDS.RESEARCHER,\n  SHEET_FIELDS.FUNDER,\n  FEATURE_HEADERS.IMPLEMENTATION,\n  SHEET_FIELDS.TARGETING,\n  SHEET_FIELDS.UNIT,\n  SHEET_FIELDS.AMOUNT,\n  SHEET_FIELDS.FREQUENCY,\n  SHEET_FIELDS.EVALUATION,\n  SHEET_FIELDS.NOTES,\n  SHEET_FIELDS.WEBSITE,\n  COMPOSITE_FIELDS.RELATED_RESOURCES\n  // SHEET_FIELDS.LINKURL1,\n  // SHEET_FIELDS.LINKTITLE1,\n  // SHEET_FIELDS.LINKURL2,\n  // SHEET_FIELDS.LINKTITLE2,\n  // SHEET_FIELDS.LINKURL3,\n  // SHEET_FIELDS.LINKTITLE3,\n  // SHEET_FIELDS.LINKURL4,\n  // SHEET_FIELDS.LINKTITLE4,\n  // SHEET_FIELDS.LINKURL5,\n  // SHEET_FIELDS.LINKTITLE5,\n  // SHEET_FIELDS.LINKURL6,\n  // SHEET_FIELDS.LINKTITLE6\n];\n\nexport { SHEET_FIELDS, FEATURE_HEADERS, COMPOSITE_FIELDS, ORDERED_CARD_FIELDS, LINK_FIELD_PAIRS };","import React from 'react';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\n\nclass UserHint extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let classes = 'user-hint';\n    if (this.props.classes) {\n      classes += ` ${this.props.classes}`;\n    }\n    if (this.props.dismissed) {\n      classes += ' dismissed';\n    }\n\n    let dismissTrigger = null;\n    if (this.props.onDismiss) {\n      dismissTrigger = <TriggerIcon iconType={ICON_TYPE.REMOVE} onClick={this.props.onDismiss} />;\n    }\n    \n    return (\n      <div className={classes}>\n        {dismissTrigger}\n        <div className='content'>{this.props.content}</div>\n      </div>\n    )\n  }\n}\n\nexport default UserHint;\n","import React from 'react';\nimport _ from 'lodash';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\nimport { SHEET_FIELDS, ORDERED_CARD_FIELDS, COMPOSITE_FIELDS, LINK_FIELD_PAIRS } from './fields';\nimport UserHint from './UserHint';\n\nconst { LOCATION, NAME, EID, TYPE, WEBSITE } = SHEET_FIELDS;\n\n// time (in seconds) before the max card user hint auto-dismisses\nconst MAX_CARD_HINT_TIMEOUT = 30;\nconst SCROLL_THROTTLE_DELAY = 500;\n\n// pure component? (shallow compare map features?) (perf)\nclass CardDock extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.containerRef = React.createRef();\n\n    // FIELDS NO LONGER EXPANDIBLE\n    // uncomment 'expand' and 'toggle'-related code here & in CSS to reactivate\n    this.state = {\n      // expandedProperties: {},\n      scrollHintDismissed: false,  \n      maxPointHintDismissed: false,\n      mapMaskActive: false\n    };\n\n    this.removeCard = this.removeCard.bind(this);\n    this.updateMask = this.updateMask.bind(this);\n    this.throttledUpdateMask = _.throttle(\n      this.throttledUpdateMask,\n      SCROLL_THROTTLE_DELAY,\n      { leading: true, trailing: true }\n    ).bind(this);\n    // this.toggleProperty = this.toggleProperty.bind(this);\n    this.dismissMaxPointHint = this.dismissMaxPointHint.bind(this);\n  }\n\n  UNSAFE_componentWillReceiveProps(newProps) {\n    if (newProps.cardData.length !== this.props.cardData.length) {\n      // necessary to ensure smooth height transitions\n      // this.setState({ expandedProperties: {} });\n\n      const cardWasRemoved = newProps.cardData.length < this.props.cardData.length;\n      if (cardWasRemoved && this.props.maxCardHintTriggered && !this.state.maxPointHintDismissed) {\n        // if a card is removed after hint is given, dismiss hint\n        this.dismissMaxPointHint();\n      }\n    }\n\n    if (!newProps.cardData.length) {\n      this.setState({ mapMaskActive: false });\n    }\n\n    if (newProps.maxCardHintTriggered !== this.props.maxCardHintTriggered) {\n      setTimeout(this.dismissMaxPointHint, 1000 * MAX_CARD_HINT_TIMEOUT);\n    }\n  }\n\n  removeCard(id) {\n    this.props.removeCard(id);\n  }\n\n  updateMask(e) {\n    this.throttledUpdateMask(e.deltaY);\n  }\n\n  throttledUpdateMask(deltaY) {\n    if (!this.state.scrollHintDismissed) {\n      this.setState({ scrollHintDismissed: true });\n    }\n\n    if (deltaY > 0) {\n      this.setState({ mapMaskActive: true });\n      return;\n    }\n\n    const { top } = this.containerRef.current.getBoundingClientRect();\n    const { innerHeight } = window;\n\n    const distanceFromBottom = innerHeight - top;\n    const mapMaskActive = distanceFromBottom > 5;\n\n    if (mapMaskActive !== this.state.mapMaskActive) {\n      this.setState({ mapMaskActive });\n    }\n  }\n\n  // toggleProperty(property, expanded) {\n  //   const expandedProperties = {...this.state.expandedProperties};\n  //   expandedProperties[property] = !expanded;\n\n  //   // necessary to ensure smooth height transitions\n  //   try {\n  //     const elems = document.getElementsByClassName(`cell ${property}`);\n  //     const greatestHeight = _.max(_.map(elems, 'scrollHeight'));\n  //     _.each(elems, elem => {\n  //       elem.style.maxHeight = greatestHeight + 20 + 'px';\n  //     })\n  //   }\n  //   catch(e) {}\n\n  //   this.setState({ expandedProperties });\n  // }\n\n  getNames() {\n    // TODO: don't bind in render (perf)\n    return this.props.cardData.map((experimentCardSet, idx) => {\n      const {\n        [EID.sheetId]: eid,\n        [NAME.sheetId]: name,\n        [TYPE.sheetId]: type\n      } = experimentCardSet[0];\n      // add type to class so we can color-code\n      const classes = `card card-${idx} ${type}`;\n      return (\n        <div className={classes} key={'header'+eid} >\n          <div className='cell'>\n            {name||'(none)'}\n            <TriggerIcon iconType={ICON_TYPE.REMOVE} onClick={this.removeCard.bind(this, eid)} />\n          </div>\n        </div>\n    )});\n  }\n\n  getRows() {\n    // form a row for each field\n    return ORDERED_CARD_FIELDS.map(field => {\n      const { displayName, sheetId, isFeatureHeader } = field;\n\n      // const expandible = this.getIsExpandible(field);\n\n      // const expanded = !!this.state.expandedProperties[sheetId];\n\n      let expandIcon = null;\n      // if (expandible) {\n      //   // TODO: also don't bind in render (perf)\n      //   const iconType = expanded ? ICON_TYPE.COLLAPSE : ICON_TYPE.EXPAND;\n      //   expandIcon = (\n      //     <TriggerIcon\n      //       onClick={this.toggleProperty.bind(this, sheetId, expanded)}\n      //       iconType={iconType}\n      //     />\n      //   );\n      // }\n\n      let cellClass = 'cell ' + sheetId;\n      // if (expandible) {\n      //   cellClass += ' expandible';\n      // }\n      // if (expanded) {\n      //   cellClass += ' expanded';\n      // }\n      if (isFeatureHeader) {\n        cellClass += ' feature-header';\n      }\n\n      // form a cell for each experiment for that field\n      const cells = this.props.cardData.map((experimentCardSet, idx) => {\n\n        const { [EID.sheetId]: eid } = experimentCardSet[0];\n        return (\n          <div className={`card card-${idx}`} key={displayName+eid}>\n            <div className={cellClass}>\n              <div className='property-name'>{displayName}{expandIcon}</div>\n              <div className={'value'}>{this.getCellContent(experimentCardSet, field)}</div>\n            </div>\n          </div>\n      )});\n      \n      return <div className='row' key={displayName}>{cells}</div>;\n    });\n  }\n\n  // whether a given row should be expandible (succinct cells don't need expand triggers)\n  // TODO: use ref, and after rerender check height, add classname accordingly?\n  // getIsExpandible(field) {\n  //   if (field === LOCATION) {\n  //     // if any experimint in the card dock has multiple locations, the location cell should be expandible\n  //     return _.some(this.props.cardData, expCardSet => expCardSet.length > 2);\n  //   }\n  //   // TODO: should fields designate isExpandible? if so, use here\n  //   if (field.isComposite || field.isFeatureHeader) {\n  //     // TODO: should composite rows (Related Resources be expandible? how to measure?)\n  //     return false;\n  //   }\n  //   if (_.some(this.props.cardData, expCardSet => this.getIsDifferentiated(expCardSet, field))) {\n  //     // if any selected experiment has differentiated data for the field, cell should be expandible\n  //     return true;\n  //   }\n\n  //   // if any experiment's value for the cell is longer than X characters\n  //   return _.some(this.props.cardData, expCardSet => {\n  //     // only need to check first location since we only hit this case if cell is undifferentiated\n  //     return expCardSet[0][field.sheetId].length > 120;\n  //   });\n  // }\n\n  // returns true if the data for a given field of a given experiment\n  // has differing values across experiment locations\n  getIsDifferentiated(experimentCardSet, field) {\n    if (field.forceUniformValue || experimentCardSet.length === 1) {\n      // certain fields we never let be differentiated\n      // and data can't be differentiated if there's only one location\n      return false;\n    }\n    const { sheetId } = field;\n    const [locationOneData, ...otherLocationsData] = experimentCardSet;\n    const firstValue = locationOneData[sheetId];\n    return _.some(otherLocationsData, l => l[sheetId] !== firstValue);\n  }\n\n  getCellContent(experimentCardSet, field) {\n    if (field === LOCATION) {\n      return this.getLocationCellContent(experimentCardSet);\n    } else if (field.isFeatureHeader) {\n      return null;\n    } else if (field === COMPOSITE_FIELDS.RELATED_RESOURCES) {\n      return this.getLinksContent(experimentCardSet);\n    }\n\n    const { sheetId } = field;\n    const firstValue = experimentCardSet[0][sheetId];\n\n    if (field === WEBSITE && firstValue.includes('.')) {\n      // make sure website is linkified if it's a link. otherwise it'll be caught\n      // by the next condition, for all undifferentiated fields\n      return <a href={firstValue} target=\"_blank\">{firstValue}</a>;\n    } else if (!this.getIsDifferentiated(experimentCardSet, field)) {\n      // for undifferentiated fields, the cell content is the field value\n      // for the first (and perhaps only) location\n      return firstValue;\n    }\n    // break cell into block for each location, as they have different values\n    return (\n      <>\n        {experimentCardSet.map(locationData => {\n          const {\n            [EID.sheetId]: eid,\n            [LOCATION.sheetId]: location,\n          } = locationData;\n          return (\n            <div key={`cell-content-${sheetId}-${eid}-${location}`}>\n              <div\n                title={location}\n                className='location-title'\n              >\n                {location}\n              </div>\n              {locationData[sheetId]}\n            </div>\n          )\n        })}\n      </>\n    );\n  }\n\n  getLocationCellContent(experimentCardSet) {\n    const cellContent = experimentCardSet.map(locationData => {\n      const {\n        [EID.sheetId]: eid,\n        [LOCATION.sheetId]: location,\n      } = locationData;\n      return (\n        <div\n          title={location}\n          className='location-cell-content'\n          key={`cell-content-location-${eid}-${location}`}\n        >\n          {location}\n        </div>\n    )});\n    return <>{cellContent}</>;\n  }\n\n  getLinksContent(experimentCardSet) {\n    const linkMap = {};\n    const orderedLinks = [];\n    experimentCardSet.forEach(locationData => {\n      LINK_FIELD_PAIRS.forEach(({ urlField, titleField }) => {\n        const urlValue = locationData[urlField.sheetId];\n        if (urlValue && !linkMap[urlValue]) {\n          linkMap[urlValue] = true;\n          const titleValue = locationData[titleField.sheetId] || urlValue;\n          orderedLinks.push({ urlValue, titleValue });\n        }\n      })\n    });\n\n    return (\n      <div\n        key={`cell-content-links-${experimentCardSet[0][EID.sheetId]}`}\n      >\n        {orderedLinks.map(({ urlValue, titleValue }) => (\n          <a key={urlValue} href={urlValue} target=\"_blank\">{titleValue}</a>\n        ))}\n      </div>\n    );\n  }\n\n  getScrollHint() {\n    const content = <>scroll for more {<TriggerIcon iconType={ICON_TYPE.D_ARROW} />}</>\n    return (\n      <UserHint\n        content={content}\n        classes={'scroll-hint'}\n        dismissed={this.state.scrollHintDismissed || this.props.maxCardHintTriggered}\n      />\n    );\n  }\n\n  getSelectionHint() {\n    const content = (\n      <>\n        click more map points to compare experiments<p className='maximum'>(max. 3)</p>\n        <TriggerIcon iconType={ICON_TYPE.R_ARROW} />\n      </>\n    );\n\n    let classes = 'selection-hint';\n    if (this.state.scrollHintDismissed) {\n      classes += ' scroll-initiated';\n    }\n    \n    return (\n      <UserHint\n        content={content}\n        classes={classes}\n        dismissed={this.props.selectionHintDismissed}\n      />\n    );\n  }\n  \n  getMaxPointHint() {\n    const content = <>Only 3 experiments may be viewed at once. Remove a card to add another experiment.</>\n\n    let classes = 'max-point-hint';\n    if (this.props.maxCardHintTriggered) {\n      classes += ' triggered'\n    }\n\n    return (\n      <UserHint\n        content={content}\n        classes={classes}\n        onDismiss={this.dismissMaxPointHint}\n        dismissed={this.state.maxPointHintDismissed}\n      />\n    );\n  }\n\n  dismissMaxPointHint() {\n    this.setState({ maxPointHintDismissed: true });\n  }\n  \n  render() {\n    if (!this.props.cardData.length) {\n      return null;\n    }\n    \n    const classes = `card-dock card-count-${this.props.cardData.length}`;\n\n    let maskClass = 'card-dock-mask';\n    if (this.state.mapMaskActive) {\n      maskClass += ` active card-count-${this.props.cardData.length}`;\n    }\n    return (\n      <div className={maskClass} onWheel={this.updateMask} onTouchMove={this.updateMask}>\n        <div\n          onWheel={this.updateMask}\n          onTouchMove={this.updateMask}\n          className={'card-dock-container'}\n          ref={this.containerRef}\n        >\n          <div className={classes}>\n            <div className=\"card-table\">\n            {this.getScrollHint()}\n            {this.getSelectionHint()}\n            {this.getMaxPointHint()}\n              <div className='row header'>{this.getNames()}</div>\n              {this.getRows()}\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default CardDock;\n","import React from 'react';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\n\nclass IntroPanel extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { open: true };\n\n    this.toggleOpen = this.toggleOpen.bind(this);\n  }\n\n  toggleOpen() {\n    this.setState(state => ({ open: !state.open }));\n  }\n\n  render() {\n    let classes = 'intro-panel';\n    if (!this.state.open) {\n      classes += ' closed';\n    }\n\n    const iconType = this.state.open ? ICON_TYPE.COLLAPSE : ICON_TYPE.EXPAND;\n    return (\n      <div className={classes}>\n        <TriggerIcon title='Info panel' onClick={this.toggleOpen} iconType={ICON_TYPE.INFO_ICON} />\n        <TriggerIcon title='Close' onClick={this.toggleOpen} iconType={ICON_TYPE.L_ARROW_STEMLESS} />\n        <div className='content'>\n          <h1>Map of Universal Basic Income Experiments and Related Programs</h1>\n          <p>How and where have Universal Basic Income (UBI) and its cousin policies been tested? What are some significant differences between these programs and which features do they share with an ideal UBI policy? What impacts can be measured when giving individuals unconditional cash on a regular basis? This geospatial map presents UBI-related experiments, pilots, programs and policies throughout the world, some past and some ongoing, and enables the user to compare them across a range of design and implementation features. It sheds light on many basic income related experiments over the past 60 years in order to inform the current dialogue around a potential basic income policy in the United States and beyond.</p>\n          <h2>INCLUSION CRITERIA</h2>\n          <p>The map contains experiments, pilots, policies and programs that have design and implementation features that crossover with the key principles of a universal basic income: unconditional, universal, regular, individual, and paid in cash. </p>\n          <p>As described in the review of the State of the Evidence on Universal Basic Income-type programs: An Umbrella Review (Hasdell, forthcoming), experiments recognized as pertinent to UBI research  are varied and can be classified into different types of cash transfer programs ranging from unconditional and universal cash to supplemental income schemes to resource dividends and minimum income guarantees (through a negative income tax). </p>\n          <p>The experiments, pilots, policies and programs we have included in this geospatial map all share multiple of the aforementioned features of a universal basic income policy and are frequently cited in the basic income literature used to infer potential impacts of a basic income policy (see Hoynes and Rothstein, 2019; Gentilini et. al, 2019, and Banerjee et. al, 2019; and Gibson et. al, 2018).</p>\n          <p>The Basic Income Lab included these experiments for this current version. Over time, we hope to add more experiments as they come to light.</p>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default IntroPanel;\n","import React from 'react';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\n\nclass Legend extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { expanded: true };\n\n    this.toggleExpand = this.toggleExpand.bind(this);\n  }\n\n  toggleExpand() {\n    this.setState(state => ({ expanded: !state.expanded }));\n  }\n\n  render() {\n    const { expanded } = this.state;\n\n    let classes = 'legend';\n    if (!expanded) {\n      classes += ' hidden';\n    }\n\n    const title = expanded ? 'Hide legend' : 'Show legend';\n\n    const iconType = expanded ? ICON_TYPE.COLLAPSE : ICON_TYPE.EXPAND;\n    return (\n      <div className={classes}>\n          <TriggerIcon title={title} onClick={this.toggleExpand} inBrackets={true} iconType={iconType} />\n          <div className='content'>\n            <div><i className='past' />Past Experiments</div>\n            <div><i className='ongoing' />Ongoing Experiments</div>\n            <div><i className='proposed' />Proposed Experiments</div>\n          </div>\n      </div>\n    )\n  }\n}\n\nexport default Legend;\n","import React from 'react';\n\nclass LoadingMask extends React.Component {\n  render() {\n    const { dataLoaded, mapLoaded, mapConfigured } = this.props;\n    let classes = 'mask';\n    if (dataLoaded && mapLoaded && mapConfigured) {\n      classes += ' loaded'\n    }\n    \n    return (\n      <div className={classes}>\n        <div className='content'>\n          <p>Loading...</p>\n          <div className='loading-dots'>\n            <div></div>\n            <div></div>\n            <div></div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default LoadingMask;\n","import React from 'react';\n\nconst POINT_BUFFER = 7;\n\nclass Tooltip extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      left: 0,\n      top: 0,\n      adjusted: false\n    };\n\n    this.ref = React.createRef();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const { expId } = nextProps;\n    if (this.props.expId === expId || !expId) {\n      // if we're still hovering the same point, don't worry about updating\n      return;\n    }\n\n    // The following steps insure a tooltip doesn't flow outside of the window bounds:\n    // 1] when we hover a new point, we initially render without adjusting the tooltip location\n    this.setState({ \n      adjusted: false,\n      left: nextProps.x,\n      top: nextProps.y\n    });\n  }\n\n  componentDidUpdate() {\n    if (this.state.adjusted || !this.props.expId) {\n      // 6] location has already been adjusted, so don't trigger a rerender\n      return;\n    }\n\n    this.adjustPosition();\n  }\n\n  adjustPosition() {\n    // 3] after the initial render, we have access to the tooltip's DOM node and can tell it's size\n    const { width: tooltipWidth, height: tooltipHeight } = this.ref.current.getBoundingClientRect();\n    const windowElement = document.getElementById('root');\n    const { width: windowWidth, height: windowHeight } = windowElement.getBoundingClientRect();\n    \n    let { left, top } = this.state;\n    // by default, tooltip appears above the point\n    top -= (tooltipHeight + POINT_BUFFER);\n    if (top < 0) {\n      // if it would run off the top of the screen, shift it below the point\n      top += tooltipHeight + POINT_BUFFER*2;\n\n      if ((top + tooltipHeight) > windowHeight) {\n        // ...unless it would then run off the bottom, in which case set it as high as possible\n        top = 1;\n      }\n    }\n\n    left += POINT_BUFFER;\n    if (left + tooltipWidth > windowWidth) {\n      // if the tooltip would run off the right of the screen, shift it left of the point\n      left -= (tooltipWidth + POINT_BUFFER*2);\n\n      if (left < 0) {\n        // ...unless it would then run off the left, in which case set it up against the right border\n        left = windowWidth - (tooltipWidth + 2);\n      }\n    }\n\n    // 4] record our adjusted coordinates, which will trigger a rerender\n    this.setState({ left, top, adjusted: true });\n  }\n  \n  getLocations() {\n    const { location, otherLocations } = this.props;\n    let hoveredClass = 'hovered-location';\n    let otherLocationElements = null;\n\n    if (otherLocations.length) {\n      hoveredClass += ' emphasized';\n      otherLocationElements = otherLocations.map(l => <p key={l}>{l}</p>);\n    }\n\n    return (\n      <>\n        <p className={hoveredClass}>{location}</p>\n        {otherLocationElements}\n      </>\n    )\n  }\n\n  render() {\n    const { expId, name, type } = this.props;\n    if (!expId) {\n      return null;\n    }\n\n    let style = {};\n    if (!this.state.adjusted) {\n      // 2] hide this initial render so user doesn't see tooltip \"jump\"\n      style = { visibility: 'hidden', left: '0px', top: '0px' };\n    } else {\n      // 5] finally, our tooltip can be told where to properly render\n      style = { left: this.state.left + 'px', top: this.state.top + 'px' };\n    }\n\n    const classes = 'tooltip ' + type;\n    return (\n      <div className={classes} style={style} ref={this.ref}>\n        <div className='name'>{name||'(none)'}</div>\n        <div className='detail'>\n          <p className='location-title'>Location:</p>\n          {this.getLocations()}\n        </div>\n        <p className='click-hint'>click point for more info</p>\n      </div>\n    )\n  }\n}\n\nexport default Tooltip;\n","import './mapbox-gl.css';\nimport './mapbox-gl-ctrl-zoom-in.svg';\nimport './mapbox-gl-ctrl-zoom-out.svg';\nimport './mapbox-gl-ctrl-attrib.svg';\nimport './mapbox-gl-ctrl-logo.svg';\nimport './App.scss';\nimport CardDock from './CardDock';\nimport IntroPanel from './IntroPanel';\nimport Legend from './Legend';\nimport LoadingMask from './LoadingMask';\nimport React from 'react';\nimport Tooltip from './Tooltip';\nimport _ from 'lodash';\nimport mapboxgl from 'mapbox-gl';\nimport styleData from './style.json';\nimport { SHEET_FIELDS } from './fields';\n\nconst { LONGITUDE, LATITUDE, NAME, LOCATION, TYPE, EID } = SHEET_FIELDS;\n\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN;\nconst MAX_SELECTED_POINTS = 3;\nconst STARTING_LNG = -19;\nconst STARTING_LAT = 29;\nconst STARTING_ZOOM = 1.5;\nconst CONTROL_QUERY_STRING = false;\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dataLoaded: false,\n      mapLoaded: false,\n      mapConfigured: false,\n      isTouchScreen: false,\n      selectionHintDismissed: false,\n      maxCardHintTriggered: false,\n      hovered: {},\n      selectedIds: []\n    };\n\n    this.mapContainer = React.createRef();\n    this.map = null;\n\n    this.getCardDock = this.getCardDock.bind(this);\n    this.getTooltip = this.getTooltip.bind(this);\n    this.removeCard = this.removeCard.bind(this);\n    this.getFeaturesByExperimentId = this.getFeaturesByExperimentId.bind(this);\n  }\n\n  componentDidMount() {\n    this.map = new mapboxgl.Map({\n      container: this.mapContainer.current,\n      style: styleData,\n      center: [STARTING_LNG, STARTING_LAT],\n      zoom: STARTING_ZOOM,\n      maxBounds: [\n        [-170.99, -80], // SW coordinates\n        [189, 85] // NE coordinates\n      ]\n    });\n\n    this.map.addControl(new mapboxgl.NavigationControl());\n    // disable map rotation using right click + drag\n    this.map.dragRotate.disable();\n    // disable map rotation using touch rotation gesture\n    this.map.touchZoomRotate.disableRotation();\n\n    this.map.on('load', this.markMapLoaded.bind(this));\n\n    this.map.on('move', _.debounce(() => {\n      this.featuresOnUnhover();\n      console.log('lat: ', this.map.getCenter().lat.toFixed(4));\n      console.log('lng: ', this.map.getCenter().lng.toFixed(4));\n      console.log('zoom: ', this.map.getZoom().toFixed(2));\n    }, 200, { leading: true, trailing: false }));  \n    \n    this.map.on('click', 'experimentSites', this.featuresOnClick.bind(this));\n    this.map.on('mouseenter', 'experimentSites', this.featuresOnHover.bind(this));\n    this.map.on('mouseleave', 'experimentSites', this.featuresOnUnhover.bind(this));\n\n    this.map.on('touchstart', 'experimentSites', this.registerTouchScreen.bind(this));\n    \n    load.call(this); \n  }\n  \n  markMapLoaded() {\n    this.setState({ mapLoaded: true });\n  }\n\n  registerTouchScreen() {\n    this.setState({ isTouchScreen: true });\n  }\n\n  getFeaturesByExperimentId(expId) {\n    const { features } = this.map.getSource('experiments')._data;\n    return features.filter(f => f.id === expId).map(f => f.properties);\n  }\n  \n  featuresOnClick(e) {\n    const { id: expId } = e.features[0];\n    const selectedIds = [...this.state.selectedIds];\n    const idx = selectedIds.indexOf(expId);\n    const alreadySelected = idx > -1;\n\n    if (!alreadySelected) {\n      if (selectedIds.length >= MAX_SELECTED_POINTS) {\n        this.setState({ maxCardHintTriggered: true });\n        return;\n      } else {\n        selectedIds.push(expId);\n      }\n    } else {\n      selectedIds.splice(idx, 1);\n    }\n\n    if (CONTROL_QUERY_STRING) {\n      const queryString = '?s=' + selectedIds.join(',');\n      window.parent.postMessage({ selectedIds: selectedIds, queryString }, \"http://localhost:1313\");\n    }\n\n    // dismiss selection hint once multiple points have been selected\n    const selectionHintDismissed = (selectedIds.length > 1) || this.state.selectionHintDismissed;\n    this.setState({ selectedIds, selectionHintDismissed });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { selected: !alreadySelected }\n    );\n  }\n\n  featuresOnHover(e) {\n    if (this.state.isTouchScreen) {\n      // devices with touch screens shouldn't have tooltips\n      return;\n    }\n    this.map.getCanvas().style.cursor = 'pointer';\n    const { id: expId, properties } = e.features[0];    \n    const { x, y } = e.point;\n\n    this.setState({ \n      hovered: {\n        name: properties[NAME.sheetId],\n        location: properties[LOCATION.sheetId],\n        type: properties[TYPE.sheetId],\n        expId,\n        x,\n        y \n      }\n    });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { hover: true }\n    );\n  }\n\n  featuresOnUnhover() {\n    if (this.state.isTouchScreen || !this.state.hovered.expId) {\n      return;\n    }\n    this.map.getCanvas().style.cursor = '';\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: this.state.hovered.expId\n      }, { hover: false }\n    );\n\n    this.setState({ hovered: {} });\n  }\n\n  removeCard(expId) {\n    const selectedIds = [...this.state.selectedIds];\n    const idx = selectedIds.indexOf(expId);\n    selectedIds.splice(idx, 1);\n\n    if (CONTROL_QUERY_STRING) {\n      const queryString = '?selected=' + selectedIds.join(',');\n      window.parent.postMessage({ selectedIds: selectedIds, queryString }, \"http://localhost:1313\");\n    }\n\n    this.setState({ selectedIds });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { selected: false }\n    );\n  }\n\n  getTooltip() {\n    const { expId, name, location, type, x, y } = this.state.hovered;\n    let otherLocations = [];\n    if (expId) {\n      const features = this.getFeaturesByExperimentId(expId);\n      otherLocations = features\n        .map(f => f.location)\n        .filter(l => l !== location);\n    }\n    return <Tooltip expId={expId} name={name} location={location} otherLocations={otherLocations} type={type} x={x} y={y}/>;\n  }\n\n  getCardDock() {\n    if (!this.map) {\n      return null;\n    }\n\n    const { selectedIds, isTouchScreen, selectionHintDismissed, maxCardHintTriggered } = this.state;\n    const cardData = selectedIds.map(this.getFeaturesByExperimentId);\n    return (\n      <CardDock\n        removeCard={this.removeCard}\n        cardData={cardData}\n        isTouchScreen={isTouchScreen}\n        selectionHintDismissed={selectionHintDismissed}\n        maxCardHintTriggered={maxCardHintTriggered}\n      />\n    );\n  }\n  \n  render() {\n    const { dataLoaded, mapLoaded, mapConfigured } = this.state;\n    const loading = !dataLoaded || !mapLoaded || !mapConfigured;\n    let classes = 'app';\n    if (loading) {\n      classes += ' loading';\n    }\n    return (\n      <div>\n        <LoadingMask dataLoaded={dataLoaded} mapLoaded={mapLoaded} mapConfigured={mapConfigured} />\n        <div className={classes}>\n          <IntroPanel />\n          {this.getCardDock()}\n          {this.getTooltip()}\n          <div ref={this.mapContainer} className='map-container' />\n          <Legend />\n        </div>\n      </div>\n    );\n  }\n}\n\nlet nextEidNumber = 1;\nconst eidMap = {};\n\nfunction load () {\n  // startsWith polyfill\n  if (!String.prototype.startsWith) {\n    Object.defineProperty(String.prototype, 'startsWith', {\n        value: function(search, rawPos) {\n            const pos = rawPos > 0 ? rawPos|0 : 0;\n            return this.substring(pos, pos + search.length) === search;\n        }\n    });\n  }\n\n  const experimentsData = { type: 'FeatureCollection', features: [] };\n\n  const reqHandler = (source, req) => {\n    const [ columnHeaderRow, ...rows ] = JSON.parse(req.responseText).feed.entry;\n    const properties = Object.keys(rows[0])\n      .filter(function (p) { \n        return p.startsWith('gsx$') & !p.endsWith('_db1zf');\n      })\n      .map(function (p) { return p.substr(4); });\n    \n    const items = rows.map(function (r, ri) {\n      const row = {};\n      properties.forEach(function (p) {\n        row[p] = r['gsx$' + p].$t === '' ? null : r['gsx$' + p].$t;\n        if ([LATITUDE.sheetId, LONGITUDE.sheetId].indexOf(p) !== -1) {\n          // mapbox wants numeric lat/long\n          row[p] = +row[p];\n        }\n        if (p === EID.sheetId) {\n          // convert the string eids from the sheet into numeric ids (which mapbox expects)\n          const stringEid = row[p];\n          const numericEid = eidMap[stringEid] || nextEidNumber++;\n          eidMap[stringEid] = numericEid;\n          row[p] = numericEid;\n        }\n        if (p === TYPE.sheetId) {\n          // force lower case to simplify equality comparisons\n          row[p] = row[p].toLowerCase();\n        }\n        if (row[p] === null) {\n          row[p] = '';\n        }\n      });\n      return {\n        type: 'Feature',\n        id: row[EID.sheetId],\n        geometry: {\n          type: 'Point',\n          coordinates: [row[LATITUDE.sheetId], row[LONGITUDE.sheetId]]\n        },\n        properties: row\n      };\n    });\n    \n    experimentsData.features.push(...items);\n    this.map.getSource('experiments').setData(experimentsData);\n    this.setState({ mapConfigured: true });\n\n    if (CONTROL_QUERY_STRING) {\n      // TODOXXX: use real eids, limit 3?, filter out non-experiments, wrap in try, unique only\n      const queryString = window.location.search;\n      const idString = window.location.search.slice(window.location.search.indexOf('=') + 1);\n      if (!idString.length) {\n        return;\n      }\n      const selectedIds = idString.split(',').map(s => Number(s));\n      const selectionHintDismissed = selectedIds.length > 1;\n      this.setState({ selectedIds, selectionHintDismissed });\n      _.each(selectedIds, id => {\n        this.map.setFeatureState({\n            source: 'experiments',\n            id,\n          }, { selected: true }\n        );\n      });\n    }\n  }\n\n  // Fetch Local Article Data\n  const experimentsReq = new XMLHttpRequest();\n  this.setState({ dataLoaded: true });\n  experimentsReq.addEventListener('load',  () => { reqHandler('experiments', experimentsReq) });\n  experimentsReq.open('GET', process.env.REACT_APP_SHEET_URL);\n  experimentsReq.send();\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}