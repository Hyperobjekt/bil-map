(this["webpackJsonpubi-map"]=this["webpackJsonpubi-map"]||[]).push([[0],{14:function(e){e.exports=JSON.parse('{"version":8,"id":"ubi-experiments","name":"UBI Experiment Map","sprite":"https://tiles.evictionlab.org/sprites","sources":{"composite":{"url":"mapbox://mapbox.mapbox-streets-v7","type":"vector"},"us-cities-10":{"type":"vector","maxzoom":10,"tiles":["https://tiles.evictionlab.org/evictions-cities-10/{z}/{x}/{y}.pbf"],"attribution":""},"us-states-10":{"type":"vector","maxzoom":10,"tiles":["https://tiles.evictionlab.org/evictions-states-10/{z}/{x}/{y}.pbf"],"attribution":""},"experiments":{"type":"geojson","data":{"type":"FeatureCollection","features":[]}}},"glyphs":"https://openmaptiles.evictionlab.org/fonts/{fontstack}/{range}.pbf","layers":[{"id":"background","type":"background","minzoom":1,"paint":{"background-color":"#f8f8f9"}},{"id":"water","type":"fill","source":"composite","source-layer":"water","filter":["==","$type","Polygon"],"layout":{"visibility":"visible"},"paint":{"fill-color":"#ececef","fill-outline-color":"#e3e3e7"}},{"id":"roads","type":"line","source":"composite","source-layer":"road","minzoom":10,"filter":["all",["==","$type","LineString"],["in","class","primary","secondary","tertiary","trunk"]],"layout":{"line-cap":"round","line-join":"round"},"paint":{"line-color":"rgba(150,150,150,1)","line-width":{"stops":[[10,0],[13,1],[14,2]]},"line-opacity":{"stops":[[10,0],[14,1]]}}},{"id":"highways","type":"line","source":"composite","source-layer":"road","minzoom":7,"filter":["all",["==","$type","LineString"],["all",["==","class","motorway"]]],"layout":{"line-cap":"round","line-join":"round","visibility":"visible"},"paint":{"line-color":"rgba(150,150,150,1)","line-width":{"stops":[[10,0],[12,1],[14,3]]},"line-opacity":{"stops":[[10,0],[12,1],[14,1]]}}},{"id":"boundary_state","type":"line","source":"us-states-10","source-layer":"states","layout":{"line-cap":"round","line-join":"bevel","visibility":"visible"},"paint":{"line-color":"rgba(248, 153, 156, 1)","line-width":{"stops":[[3,1],[7,2]]},"line-blur":0.4,"line-opacity":0.8}},{"id":"roads-highways_text","type":"symbol","source":"composite","source-layer":"road_label","minzoom":11,"filter":["in","class","motorway","primary","secondary","tertiary","trunk"],"layout":{"text-size":13,"text-max-angle":45,"text-transform":"none","symbol-spacing":250,"text-font":["Lato+Bold"],"symbol-placement":"line","text-rotation-alignment":"map","text-pitch-alignment":"viewport","text-field":"{name}","text-letter-spacing":0.05,"text-keep-upright":true},"paint":{"text-color":"rgba(5, 4, 3, 1)","text-halo-color":"rgba(255,255,255,1)","text-translate":[0,0],"text-halo-width":2,"text-halo-blur":1}},{"id":"experimentSites","type":"circle","source":"experiments","paint":{"circle-color":["case",["==",["get","type"],"past"],"rgb(0,80,92)",["==",["get","type"],"proposed"],"rgb(223,70,73)",["==",["get","type"],"ongoing"],"rgb(175,105,12)","gray"],"circle-opacity":0.8,"circle-radius":["interpolate",["exponential",1.3],["zoom"],1,["*",1,["case",["boolean",["feature-state","selected"],false],8.5,["boolean",["feature-state","hover"],false],7,5]],10,["*",8,["case",["boolean",["feature-state","selected"],false],8.5,["boolean",["feature-state","hover"],false],7,5]]],"circle-blur":["case",["boolean",["feature-state","hover"],false],0.2,["boolean",["feature-state","selected"],false],0,0]}},{"id":"cluster_count","type":"symbol","source":"experiments","filter":["has","point_count"],"layout":{"text-field":"{point_count_abbreviated}","text-font":["Lato+Bold"],"text-size":11},"paint":{"text-color":"rgb(255,255,255)"}},{"id":"city_extra_small_labels","type":"symbol","source":"us-cities-10","source-layer":"cities-centers","minzoom":10,"filter":["all",[">=","p-10",50000],["<","p-10",75000]],"layout":{"text-size":{"stops":[[10,10],[12,14]]},"text-transform":"uppercase","text-font":["Lato+Bold"],"text-justify":"left","text-offset":[-2,-1],"text-anchor":"left","text-field":"{n}","text-padding":0.5,"text-letter-spacing":0.13},"paint":{"text-color":"rgba(102, 102, 102, 1)","text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":{"stops":[[1,2],[11,3]]},"text-halo-blur":1,"text-opacity":1}},{"id":"city_small_labels","type":"symbol","source":"us-cities-10","source-layer":"cities-centers","minzoom":8,"filter":["all",[">=","p-10",75000],["<","p-10",100000]],"layout":{"text-size":{"stops":[[6,12],[10,16]]},"text-transform":"uppercase","text-font":["Lato+Bold"],"text-justify":"left","text-field":"{n}","text-letter-spacing":{"stops":[[6,0.12],[10,0.12]]},"text-padding":2,"text-offset":["interpolate",["linear"],["zoom"],6,["literal",[-1,-0.5]],12,["literal",[-2,-1]]]},"paint":{"text-color":"rgba(102, 102, 102, 1)","text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":{"stops":[[6,1],[10,2]]},"text-halo-blur":1,"icon-opacity":0,"text-opacity":1}},{"id":"city_mid_labels","type":"symbol","source":"us-cities-10","source-layer":"cities-centers","minzoom":6,"maxzoom":14,"filter":["all",[">=","p-10",100000],["<","p-10",500000]],"layout":{"text-size":{"stops":[[5,12],[10,15]]},"text-transform":"uppercase","text-font":["Lato+Bold"],"text-justify":"center","text-anchor":"center","text-field":"{n}","text-padding":0,"text-letter-spacing":0.12,"icon-allow-overlap":true,"icon-ignore-placement":true,"text-offset":["interpolate",["linear"],["zoom"],6,["literal",[-1,-0.5]],10,["literal",[-2,-1]]]},"paint":{"text-color":{"stops":[[5,"rgba(5, 4, 3, 1)"],[10,"rgba(102, 102, 102, 1)"]]},"text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":{"stops":[[5,2],[6,2]]},"text-halo-blur":1,"icon-opacity":1,"icon-color":"rgba(0, 0, 0, 1)"}},{"id":"city_large_labels","type":"symbol","source":"us-cities-10","source-layer":"cities-centers","minzoom":6,"maxzoom":14,"filter":[">=","p-10",500000],"layout":{"text-size":{"stops":[[6,14],[10,20]]},"text-transform":"uppercase","text-font":["Lato+Bold"],"text-justify":"center","text-anchor":"center","text-field":"{n}","text-padding":0,"text-letter-spacing":0.12,"icon-allow-overlap":true,"icon-ignore-placement":true,"text-offset":["interpolate",["linear"],["zoom"],6,["literal",[-1,-0.5]],10,["literal",[-2,-1]]]},"paint":{"text-color":"rgba(5, 4, 3, 1)","text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":{"stops":[[5,2],[6,2]]},"text-halo-blur":1,"icon-opacity":1,"icon-color":"rgba(0, 0, 0, 1)"}}]}')},16:function(e,t,a){e.exports=a(25)},21:function(e,t,a){},24:function(e,t,a){},25:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),s=a(13),r=a.n(s),o=(a(21),a(9)),l=a(10),c=a(2),p=a(3),d=a(5),u=a(4),m=a(1),h=a(6),y=a(15),f=a(8),g=a.n(f),E="remove",x="expand",v="collapse",b="down-arrow",I="right-arrow",k=function(e){function t(e){return Object(c.a)(this,t),Object(d.a)(this,Object(u.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"onClick",value:function(){this.props.onClick()}},{key:"getRemove",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("line",{x1:"15",x2:"85",y1:"15",y2:"85"}),n.a.createElement("line",{x1:"15",x2:"85",y1:"85",y2:"15"}))}},{key:"getExpand",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("line",{x1:"15",x2:"85",y1:"50",y2:"50"}),n.a.createElement("line",{x1:"50",x2:"50",y1:"15",y2:"85"}))}},{key:"getCollapse",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("line",{x1:"20",x2:"80",y1:"50",y2:"50"}))}},{key:"getDownArrow",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("polyline",{points:"50,0 50,100"}),n.a.createElement("polyline",{points:"10,55 50,100 90,55"}))}},{key:"getBracketWrap",value:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement("polyline",{points:"15,0 0,0 0,100 15,100"}),e,n.a.createElement("polyline",{points:"85,0 100,0 100,100 85,100"}))}},{key:"render",value:function(){var e,t="trigger-icon ",a="";switch(this.props.iconType){case E:e=this.getRemove(),t+="remove-icon";break;case x:e=this.getExpand(),t+="expand-icon";break;case v:e=this.getCollapse(),t+="collapse-icon";break;case b:e=this.getDownArrow(),t+="down-arrow";break;case I:e=this.getDownArrow(),t+="right-arrow",a+="rotate(270)";break;default:console.error("incorrect type")}return this.props.inBrackets&&(t+=" bracketed",e=this.getBracketWrap(e)),n.a.createElement("svg",{onClick:this.props.onClick,viewBox:"0 0 100 100",transform:a,className:t},e)}}]),t}(n.a.Component),N={LONGITUDE:{displayName:"Longitude",sheetId:"longitude"},LATITUDE:{displayName:"Latitude",sheetId:"latitude"},EID:{displayName:"Experiment ID",sheetId:"eid"},NAME:{displayName:"Name of Experiment",sheetId:"name"},TYPE:{displayName:"Past, Ongoing, Proposed",sheetId:"type"},LOCATION:{displayName:"Location",sheetId:"location"},DATES:{displayName:"Implementation Dates",sheetId:"dates"},RECIPIENTS:{displayName:"Number of Recipients",sheetId:"recipients"},IMPLEMENTER:{displayName:"Implementing Agency",sheetId:"implementer",isExpandible:!0},RESEARCHER:{displayName:"Research Agency",sheetId:"researcher",isExpandible:!0},FUNDER:{displayName:"Funding Agency",sheetId:"funder",isExpandible:!0},TARGETING:{displayName:"Type of Targeting",sheetId:"targeting",isExpandible:!0},UNIT:{displayName:"Unit of Recipient",sheetId:"unit"},AMOUNT:{displayName:"Amount of Transfer",sheetId:"amount",isExpandible:!0},FREQUENCY:{displayName:"Frequency of Payment",sheetId:"frequency"},EVALUATION:{displayName:"Method of Evaluation",sheetId:"evaluation"},NOTES:{displayName:"Additional Notes of Interest",sheetId:"notes",isExpandible:!0},WEBSITE:{displayName:"Link to Website",sheetId:"website",forceUniformValue:!0},LINKURL1:{displayName:"Link to Related Resource 1",sheetId:"linkurl1"},LINKTITLE1:{displayName:"Link title 1",sheetId:"linktitle1"},LINKURL2:{displayName:"Link to Related Resource 2",sheetId:"linkurl2"},LINKTITLE2:{displayName:"Link title 2",sheetId:"linktitle2"},LINKURL3:{displayName:"Link to Related Resource 3",sheetId:"linkurl3"},LINKTITLE3:{displayName:"Link title 3",sheetId:"linktitle3"},LINKURL4:{displayName:"Link to Related Resource 4",sheetId:"linkurl4"},LINKTITLE4:{displayName:"Link title 4",sheetId:"linktitle4"},LINKURL5:{displayName:"Link to Related Resource 5",sheetId:"linkurl5"},LINKTITLE5:{displayName:"Link title 5",sheetId:"linktitle5"},LINKURL6:{displayName:"Link to Related Resource 6",sheetId:"linkurl6"},LINKTITLE6:{displayName:"Link title 6",sheetId:"linktitle6"}},L=[{urlField:N.LINKURL1,titleField:N.LINKTITLE1},{urlField:N.LINKURL2,titleField:N.LINKTITLE2},{urlField:N.LINKURL3,titleField:N.LINKTITLE3},{urlField:N.LINKURL4,titleField:N.LINKTITLE4},{urlField:N.LINKURL5,titleField:N.LINKTITLE5},{urlField:N.LINKURL6,titleField:N.LINKTITLE6}],T={ORGANIZATIONAL:{displayName:"ORGANIZATIONAL FEATURES",sheetId:null,isFeatureHeader:!0},IMPLEMENTATION:{displayName:"IMPLEMENTATION FEATURES",sheetId:null,isFeatureHeader:!0}},O={RELATED_RESOURCES:{displayName:"Links to Related Resources",sheetId:null,isExpandible:!0}},C=[N.LOCATION,N.DATES,N.RECIPIENTS,T.ORGANIZATIONAL,N.IMPLEMENTER,N.RESEARCHER,N.FUNDER,T.IMPLEMENTATION,N.TARGETING,N.UNIT,N.AMOUNT,N.FREQUENCY,N.EVALUATION,N.NOTES,N.WEBSITE,O.RELATED_RESOURCES],R=function(e){function t(e){return Object(c.a)(this,t),Object(d.a)(this,Object(u.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e="user-hint";return this.props.classes&&(e+=" ".concat(this.props.classes)),this.props.dismissed&&(e+=" dismissed"),n.a.createElement("div",{className:e},n.a.createElement("div",{className:"content"},this.props.content))}}]),t}(n.a.Component),j=N.LOCATION,S=N.NAME,D=N.EID,F=N.TYPE,A=N.WEBSITE,z=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(u.a)(t).call(this,e))).state={minimized:!0,expandedProperties:{},scrollHintDismissed:!1},a.removeCard=a.removeCard.bind(Object(m.a)(a)),a.slideDock=a.slideDock.bind(Object(m.a)(a)),a.toggleDock=a.toggleDock.bind(Object(m.a)(a)),a.maximizeDock=a.maximizeDock.bind(Object(m.a)(a)),a.toggleProperty=a.toggleProperty.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"removeCard",value:function(e){this.props.removeCard(e)}},{key:"slideDock",value:function(e){e.deltaY&&e.deltaY>0&&this.setState({minimized:!1,scrollHintDismissed:!0})}},{key:"toggleDock",value:function(){var e=this;this.setState((function(t){return{minimized:!e.state.minimized}}))}},{key:"maximizeDock",value:function(){this.setState((function(e){return{minimized:!1}}))}},{key:"toggleProperty",value:function(e,t){var a=Object(y.a)({},this.state.expandedProperties);a[e]=!t,this.setState({expandedProperties:a})}},{key:"getNames",value:function(){var e=this;return this.props.cardData.map((function(t){var a=t[0],i=a[D.sheetId],s=a[S.sheetId],r="name "+a[F.sheetId];return n.a.createElement("td",{key:"name"+i,className:r},s||"(none)",n.a.createElement(k,{iconType:E,onClick:e.removeCard.bind(e,i)}))}))}},{key:"getRows",value:function(){var e=this;return C.map((function(t){var a=t.displayName,i=(t.sheetId,t.isFeatureHeader),s=e.getIsExpandible(t),r=!!e.state.expandedProperties[t.sheetId],o=null;if(s){var l=r?v:x;o=n.a.createElement(k,{onClick:e.toggleProperty.bind(e,t.sheetId,r),iconType:l})}var c="property-cell";s&&(c+=" expandible"),i&&(c+=" feature-header");var p="property-value";r&&(p+=" expanded");var d=e.props.cardData.map((function(i){var s=e.getCellContent(i,t),r=i[0][D.sheetId];return n.a.createElement("td",{className:c,key:a+"-td-"+r},n.a.createElement("div",{className:"property-name"},a,o),n.a.createElement("div",{className:p},s))}));return n.a.createElement("tr",{className:"property-row",key:a},d)}))}},{key:"getIsExpandible",value:function(e){return e===j?g.a.some(this.props.cardData,(function(e){return e.length>1})):e.isExpandible}},{key:"getCellContent",value:function(e,t){if(t===j)return this.getLocationCellContent(e);if(t.isFeatureHeader)return null;if(t===O.RELATED_RESOURCES)return this.getLinksContent(e);var a,i=t.sheetId,s=Object(o.a)(e),r=s[0],l=s.slice(1),c=r[i],p=t.forceUniformValue||g.a.every(l,(function(e){return e[i]===c}));return a=t===A&&c.includes(".")?n.a.createElement("a",{href:c,target:"_blank"},c):p?c:e.map((function(e){var t=e[D.sheetId],a=e[j.sheetId];return n.a.createElement("div",{key:"cell-content-".concat(i,"-").concat(t,"-").concat(a)},n.a.createElement("div",{title:a,className:"property-location-title"},a),e[i])})),n.a.createElement(n.a.Fragment,null,a)}},{key:"getLocationCellContent",value:function(e){var t=e.map((function(e){var t=e[D.sheetId],a=e[j.sheetId];return n.a.createElement("div",{title:a,className:"location-cell-content",key:"cell-content-location-".concat(t,"-").concat(a)},a)}));return n.a.createElement(n.a.Fragment,null,t)}},{key:"getLinksContent",value:function(e){var t={},a=[];return e.forEach((function(e){L.forEach((function(i){var n=i.urlField,s=i.titleField,r=e[n.sheetId];if(r&&!t[r]){t[r]=!0;var o=e[s.sheetId]||r;a.push({urlValue:r,titleValue:o})}}))})),n.a.createElement("div",{key:"cell-content-links-".concat(e[0][D.sheetId])},a.map((function(e){var t=e.urlValue,a=e.titleValue;return n.a.createElement("a",{key:t,href:t,target:"_blank"},a)})))}},{key:"getScrollHint",value:function(){var e=n.a.createElement(n.a.Fragment,null,"scroll for more ",n.a.createElement(k,{iconType:b}));return n.a.createElement(R,{content:e,classes:"scroll-hint",dismissed:this.state.scrollHintDismissed})}},{key:"getSelectionHint",value:function(){var e=n.a.createElement(n.a.Fragment,null,"click more map points to compare experiments",n.a.createElement("p",{className:"maximum"},"(max. 3)"),n.a.createElement(k,{iconType:I})),t="selection-hint ";return this.state.scrollHintDismissed&&(t+="sole-hint"),n.a.createElement(R,{content:e,classes:t,dismissed:this.props.selectionHintDismissed})}},{key:"render",value:function(){if(!this.props.cardData.length)return null;var e="card-dock-container ";return e+="card-count-".concat(this.props.cardData.length),this.state.minimized||(e+=" maximized"),n.a.createElement("div",{onWheel:this.slideDock,onDoubleClick:this.toggleDock,onTouchStart:this.maximizeDock,className:"card-dock-wrapper"},n.a.createElement("div",{className:e},this.getScrollHint(),this.getSelectionHint(),n.a.createElement("table",{className:"card-dock"},n.a.createElement("thead",null,n.a.createElement("tr",null,this.getNames())),n.a.createElement("tbody",null,this.getRows()))))}}]),t}(n.a.PureComponent),w=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(u.a)(t).call(this,e))).state={expanded:!0},a.toggleExpand=a.toggleExpand.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"toggleExpand",value:function(){this.setState((function(e){return{expanded:!e.expanded}}))}},{key:"render",value:function(){var e="legend";this.state.expanded||(e+=" hidden");var t=this.state.expanded?v:x;return n.a.createElement("div",{className:e},n.a.createElement(k,{onClick:this.toggleExpand,inBrackets:!0,iconType:t}),n.a.createElement("div",{className:"content"},n.a.createElement("div",null,n.a.createElement("i",{className:"past"}),"Past Experiments"),n.a.createElement("div",null,n.a.createElement("i",{className:"ongoing"}),"Ongoing Experiments"),n.a.createElement("div",null,n.a.createElement("i",{className:"proposed"}),"Proposed Experiments")))}}]),t}(n.a.Component),U=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(u.a)(t).call(this,e))).state={left:0,top:0,adjusted:!1},a.ref=n.a.createRef(),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.expId;this.props.expId!==t&&t&&this.setState({adjusted:!1,left:e.x,top:e.y})}},{key:"componentDidUpdate",value:function(){!this.state.adjusted&&this.props.expId&&this.adjustPosition()}},{key:"adjustPosition",value:function(){var e=this.ref.current.getBoundingClientRect(),t=e.width,a=e.height,i=document.getElementById("root").getBoundingClientRect(),n=i.width,s=i.height,r=this.state,o=r.left,l=r.top;(l-=a+7)<0&&(l+=a+14)+a>s&&(l=1),(o+=7)+t>n&&(o-=t+14)<0&&(o=n-(t+2)),this.setState({left:o,top:l,adjusted:!0})}},{key:"getLocations",value:function(){var e=this.props,t=e.location,a=e.otherLocations,i="hovered-location",s=null;return a.length&&(i+=" emphasized",s=a.map((function(e){return n.a.createElement("p",{key:e},e)}))),n.a.createElement(n.a.Fragment,null,n.a.createElement("p",{className:i},t),s)}},{key:"render",value:function(){var e=this.props,t=e.expId,a=e.name,i=e.type;if(!t)return null;var s={};s=this.state.adjusted?{left:this.state.left+"px",top:this.state.top+"px"}:{visibility:"hidden",left:"0px",top:"0px"};var r="tooltip "+i;return n.a.createElement("div",{className:r,style:s,ref:this.ref},n.a.createElement("div",{className:"name"},a||"(none)"),n.a.createElement("div",{className:"detail"},n.a.createElement("p",{className:"location-title"},"Location:"),this.getLocations()),n.a.createElement("p",{className:"click-hint"},"click point for more info"))}}]),t}(n.a.Component),B=a(11),P=a.n(B),M=a(14),K=(a(24),N.LONGITUDE),H=N.LATITUDE,_=N.NAME,W=N.LOCATION,Y=N.TYPE,G=N.EID;P.a.accessToken="pk.eyJ1IjoiYmFzaWMtaW5jb21lIiwiYSI6ImNrOG93Y3UyYzFkZmozZXFzMDh6M2VzMmYifQ.03d6tNOzklWysbEpgpe6dg";var q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(u.a)(t).call(this,e))).state={lat:40.66995747013945,lng:-103.59179687498357,zoom:3,hovered:{},selectedIds:[],isTouchScreen:!1,selectionHintDismissed:!1},a.map=null,a.getCardDock=a.getCardDock.bind(Object(m.a)(a)),a.getTooltip=a.getTooltip.bind(Object(m.a)(a)),a.removeCard=a.removeCard.bind(Object(m.a)(a)),a.getFeaturesByExperimentId=a.getFeaturesByExperimentId.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.map=new P.a.Map({container:this.mapContainer,style:M,center:[this.state.lng,this.state.lat],zoom:this.state.zoom}),this.map.on("move",(function(){e.featuresOnUnhover(),e.setState({lng:e.map.getCenter().lng.toFixed(4),lat:e.map.getCenter().lat.toFixed(4),zoom:e.map.getZoom().toFixed(2)})})),this.map.on("click","experimentSites",this.featuresOnClick.bind(this)),this.map.on("mouseenter","experimentSites",this.featuresOnHover.bind(this)),this.map.on("mouseleave","experimentSites",this.featuresOnUnhover.bind(this)),this.map.on("touchstart","experimentSites",this.touchstart.bind(this)),$.call(this)}},{key:"touchstart",value:function(e){this.setState({isTouchScreen:!0})}},{key:"getFeaturesByExperimentId",value:function(e){return this.map.getSource("experiments")._data.features.filter((function(t){return t.id===e})).map((function(e){return e.properties}))}},{key:"featuresOnClick",value:function(e){var t=e.features[0].id,a=Object(l.a)(this.state.selectedIds),i=a.indexOf(t),n=i>-1;if(n)a.splice(i,1);else{if(a.length>=3)return void console.log("OH SHET!");a.push(t)}var s=a.length>1||this.state.selectionHintDismissed;this.setState({selectedIds:a,selectionHintDismissed:s}),this.map.setFeatureState({source:"experiments",id:t},{selected:!n})}},{key:"featuresOnHover",value:function(e){if(!this.state.isTouchScreen){this.map.getCanvas().style.cursor="pointer";var t=e.features[0],a=t.id,i=t.properties,n=e.point,s=n.x,r=n.y;this.setState({hovered:{name:i[_.sheetId],location:i[W.sheetId],type:i[Y.sheetId],expId:a,x:s,y:r}}),this.map.setFeatureState({source:"experiments",id:a},{hover:!0})}}},{key:"featuresOnUnhover",value:function(){!this.state.isTouchScreen&&this.state.hovered.expId&&(this.map.getCanvas().style.cursor="",this.map.setFeatureState({source:"experiments",id:this.state.hovered.expId},{hover:!1}),this.setState({hovered:{}}))}},{key:"removeCard",value:function(e){var t=Object(l.a)(this.state.selectedIds),a=t.indexOf(e);t.splice(a,1),this.setState({selectedIds:t}),this.map.setFeatureState({source:"experiments",id:e},{selected:!1})}},{key:"getTooltip",value:function(){var e=this.state.hovered,t=e.expId,a=e.name,i=e.location,s=e.type,r=e.x,o=e.y,l=[];t&&(l=this.getFeaturesByExperimentId(t).map((function(e){return e.location})).filter((function(e){return e!==i})));return n.a.createElement(U,{expId:t,name:a,location:i,otherLocations:l,type:s,x:r,y:o})}},{key:"getCardDock",value:function(){if(!this.map)return null;var e=this.state,t=e.selectedIds,a=e.isTouchScreen,i=e.selectionHintDismissed,s=t.map(this.getFeaturesByExperimentId);return n.a.createElement(z,{removeCard:this.removeCard,cardData:s,isTouchScreen:a,selectionHintDismissed:i})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"app"},this.getCardDock(),this.getTooltip(),n.a.createElement("div",{ref:function(t){return e.mapContainer=t},className:"map-container"}),n.a.createElement(w,null))}}]),t}(n.a.Component),J=1,V={};function $(){var e=this;String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var a=t>0?0|t:0;return this.substring(a,a+e.length)===e}});var t={type:"FeatureCollection",features:[]},a=new XMLHttpRequest;a.addEventListener("load",(function(){!function(a,i){var n,s=Object(o.a)(JSON.parse(i.responseText).feed.entry),r=(s[0],s.slice(1)),c=Object.keys(r[0]).filter((function(e){return e.startsWith("gsx$")&!e.endsWith("_db1zf")})).map((function(e){return e.substr(4)})),p=r.map((function(e,t){var a={};return c.forEach((function(t){if(a[t]=""===e["gsx$"+t].$t?null:e["gsx$"+t].$t,-1!==[H.sheetId,K.sheetId].indexOf(t)&&(a[t]=+a[t]),t===G.sheetId){var i=a[t],n=V[i]||J++;V[i]=n,a[t]=n}t===Y.sheetId&&(a[t]=a[t].toLowerCase()),null===a[t]&&(a[t]="")})),{type:"Feature",id:a[G.sheetId],geometry:{type:"Point",coordinates:[a[H.sheetId],a[K.sheetId]]},properties:a}}));(n=t.features).push.apply(n,Object(l.a)(p)),e.map.getSource("experiments").setData(t)}(0,a)})),console.log("https://spreadsheets.google.com/feeds/list/1Bg3aEi3M7N4OGFJu2DYBIEqBtqJX6-mqCMbBbAcKNkg/1/public/full?alt=json"),a.open("GET","https://spreadsheets.google.com/feeds/list/1Bg3aEi3M7N4OGFJu2DYBIEqBtqJX6-mqCMbBbAcKNkg/1/public/full?alt=json"),a.send()}var Z=q;r.a.render(n.a.createElement(Z,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.5ce2b355.chunk.js.map