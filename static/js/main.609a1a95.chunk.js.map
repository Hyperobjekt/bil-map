{"version":3,"sources":["TriggerIcon.js","fields.js","UserHint.js","CardDock.js","Legend.js","Tooltip.js","App.js","index.js"],"names":["ICON_TYPE","TriggerIcon","props","this","onClick","x1","x2","y1","y2","points","icon","classes","transform","iconType","getRemove","getExpand","getCollapse","getDownArrow","console","error","inBrackets","getBracketWrap","viewBox","className","React","Component","SHEET_FIELDS","LONGITUDE","displayName","sheetId","LATITUDE","EID","NAME","TYPE","LOCATION","DATES","RECIPIENTS","IMPLEMENTER","isExpandible","RESEARCHER","FUNDER","TARGETING","UNIT","AMOUNT","FREQUENCY","EVALUATION","NOTES","WEBSITE","forceUniformValue","LINKURL1","LINKTITLE1","LINKURL2","LINKTITLE2","LINKURL3","LINKTITLE3","LINKURL4","LINKTITLE4","LINKURL5","LINKTITLE5","LINKURL6","LINKTITLE6","LINK_FIELD_PAIRS","urlField","titleField","FEATURE_HEADERS","ORGANIZATIONAL","isFeatureHeader","IMPLEMENTATION","COMPOSITE_FIELDS","RELATED_RESOURCES","isComposite","ORDERED_CARD_FIELDS","UserHint","dismissed","content","CardDock","state","minimized","expandedProperties","scrollHintDismissed","removeCard","bind","slideDock","toggleDock","maximizeDock","toggleProperty","newProps","cardData","length","setState","id","e","deltaY","property","expanded","elems","document","getElementsByClassName","greatestHeight","_","max","map","each","elem","style","maxHeight","experimentCardSet","idx","eid","name","type","key","field","expandible","getIsExpandible","expandIcon","cellClass","cells","getCellContent","some","expCardSet","getIsDifferentiated","locationOneData","otherLocationsData","firstValue","l","getLocationCellContent","getLinksContent","includes","href","target","locationData","location","title","cellContent","linkMap","orderedLinks","forEach","urlValue","titleValue","push","selectionHintDismissed","onWheel","onDoubleClick","onTouchStart","getScrollHint","getSelectionHint","getNames","getRows","PureComponent","Legend","toggleExpand","Tooltip","left","top","adjusted","ref","createRef","nextProps","expId","x","y","adjustPosition","current","getBoundingClientRect","tooltipWidth","width","tooltipHeight","height","getElementById","windowWidth","windowHeight","POINT_BUFFER","otherLocations","hoveredClass","otherLocationElements","visibility","getLocations","mapboxgl","accessToken","process","App","lat","lng","zoom","hovered","selectedIds","isTouchScreen","getCardDock","getTooltip","getFeaturesByExperimentId","Map","container","mapContainer","styleData","center","on","featuresOnUnhover","log","getCenter","toFixed","getZoom","removeMapMask","featuresOnClick","featuresOnHover","registerTouchScreen","load","call","Date","getSource","_data","features","filter","f","properties","indexOf","alreadySelected","splice","setFeatureState","source","selected","getCanvas","cursor","point","hover","el","nextEidNumber","eidMap","String","prototype","startsWith","Object","defineProperty","value","search","rawPos","pos","substring","experimentsData","experimentsReq","XMLHttpRequest","addEventListener","req","JSON","parse","responseText","feed","entry","rows","keys","p","endsWith","substr","items","r","ri","row","$t","stringEid","numericEid","toLowerCase","geometry","coordinates","setData","reqHandler","open","send","ReactDOM","render"],"mappings":"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","file":"static/js/main.609a1a95.chunk.js","sourcesContent":["import React from 'react';\n\nconst ICON_TYPE = {\n  REMOVE: 'remove',\n  EXPAND: 'expand',\n  COLLAPSE: 'collapse',\n  D_ARROW: 'down-arrow',\n  R_ARROW: 'right-arrow'\n};\n\nclass TriggerIcon extends React.Component {\n  constructor(props) {\n    super(props)\n  }\n\n  onClick() {\n    this.props.onClick();\n  }\n\n  getRemove() {\n    return (\n      <>\n        <line x1='15' x2='85' y1='15' y2='85'/>\n        <line x1='15' x2='85' y1='85' y2='15'/>\n      </>\n    )    \n  }\n  \n  getExpand() {\n    return (\n      <>\n        <line x1='15' x2='85' y1='50' y2='50'/>\n        <line x1='50' x2='50' y1='15' y2='85'/>\n      </>\n    )    \n  }\n\n  getCollapse() {\n    return (\n      <>\n        <line x1='20' x2='80' y1='50' y2='50'/>\n      </>\n    )    \n  }\n\n  getDownArrow() {\n    return (\n      <>\n        <polyline points='50,0 50,100' />\n        <polyline points='10,55 50,100 90,55' />\n      </>\n    )\n  }\n  \n  getBracketWrap(icon) {\n    return (\n      <>\n        <polyline points='15,0 0,0 0,100 15,100' />\n          {icon}\n        <polyline points='85,0 100,0 100,100 85,100' />\n      </>\n    )    \n  }\n  \n  render() {\n    let icon;\n    let classes = 'trigger-icon ';\n    let transform = '';\n    switch (this.props.iconType) {\n      case ICON_TYPE.REMOVE:\n        icon = this.getRemove();\n        classes += 'remove-icon';\n        break;\n      case ICON_TYPE.EXPAND:\n        icon = this.getExpand();\n        classes += 'expand-icon';\n        break;\n      case ICON_TYPE.COLLAPSE:\n        icon = this.getCollapse();\n        classes += 'collapse-icon';\n        break;\n      case ICON_TYPE.D_ARROW:\n        icon = this.getDownArrow();\n        classes += 'down-arrow';\n        break;\n      case ICON_TYPE.R_ARROW:\n        icon = this.getDownArrow();\n        classes += 'right-arrow';\n        transform += 'rotate(270)';\n        break;\n      default:\n        console.error('incorrect type');\n    }\n\n    if (this.props.inBrackets) {\n      classes += ' bracketed';\n      icon = this.getBracketWrap(icon);\n    }\n\n    return (\n      <svg\n        onClick={this.props.onClick}\n        viewBox='0 0 100 100'\n        transform={transform}\n        className={classes}\n      >\n        {icon}\n      </svg>\n    )\n  }\n}\n\nexport default TriggerIcon;\nexport { ICON_TYPE };\n","const SHEET_FIELDS = {\n  LONGITUDE: {\n    displayName: 'Longitude', // how the field will appear on the card\n    sheetId: 'longitude' // corresponds to the column header on the google sheet\n  },\n  LATITUDE: {\n    displayName: 'Latitude',\n    sheetId: 'latitude'\n  },\n  // NOTE: Used to bind the different locations of a given experiment together.\n  // We use it as the mapbox ID for the feature to simplify unified hover/selection styling.\n  EID: {\n    displayName: 'Experiment ID',\n    sheetId: 'eid'\n  },\n  NAME: {\n    displayName: 'Name of Experiment',\n    sheetId: 'name'\n  },\n  TYPE: {\n    displayName: 'Past, Ongoing, Proposed',\n    sheetId: 'type'\n  },\n  LOCATION: {\n    displayName: 'Location',\n    sheetId: 'location'\n  },\n  DATES: {\n    displayName: 'Implementation Dates',\n    sheetId: 'dates'\n  },\n  RECIPIENTS: {\n    displayName: 'Number of Recipients',\n    sheetId: 'recipients'\n  },\n  IMPLEMENTER: {\n    displayName: 'Implementing Agency',\n    sheetId: 'implementer',\n    isExpandible: true\n  },\n  RESEARCHER: {\n    displayName: 'Research Agency',\n    sheetId: 'researcher',\n    isExpandible: true\n  },\n  FUNDER: {\n    displayName: 'Funding Agency',\n    sheetId: 'funder',\n    isExpandible: true\n  },\n  TARGETING: {\n    displayName: 'Type of Targeting',\n    sheetId: 'targeting',\n    isExpandible: true\n  },\n  UNIT: {\n    displayName: 'Unit of Recipient',\n    sheetId: 'unit'\n  },\n  AMOUNT: {\n    displayName: 'Amount of Transfer',\n    sheetId: 'amount',\n    isExpandible: true\n  },\n  FREQUENCY: {\n    displayName: 'Frequency of Payment',\n    sheetId: 'frequency'\n  },\n  EVALUATION: {\n    displayName: 'Method of Evaluation',\n    sheetId: 'evaluation'\n  },\n  NOTES: {\n    displayName: 'Additional Notes of Interest',\n    sheetId: 'notes',\n    isExpandible: true\n  },\n  WEBSITE: {\n    displayName: 'Link to Website',\n    sheetId: 'website',\n    forceUniformValue: true\n  },\n  LINKURL1: {\n    displayName: 'Link to Related Resource 1',\n    sheetId: 'linkurl1'\n  },\n  LINKTITLE1: {\n    displayName: 'Link title 1',\n    sheetId: 'linktitle1'\n  },\n  LINKURL2: {\n    displayName: 'Link to Related Resource 2',\n    sheetId: 'linkurl2'\n  },\n  LINKTITLE2: {\n    displayName: 'Link title 2',\n    sheetId: 'linktitle2'\n  },\n  LINKURL3: {\n    displayName: 'Link to Related Resource 3',\n    sheetId: 'linkurl3'\n  },\n  LINKTITLE3: {\n    displayName: 'Link title 3',\n    sheetId: 'linktitle3'\n  },\n  LINKURL4: {\n    displayName: 'Link to Related Resource 4',\n    sheetId: 'linkurl4'\n  },\n  LINKTITLE4: {\n    displayName: 'Link title 4',\n    sheetId: 'linktitle4'\n  },\n  LINKURL5: {\n    displayName: 'Link to Related Resource 5',\n    sheetId: 'linkurl5'\n  },\n  LINKTITLE5: {\n    displayName: 'Link title 5',\n    sheetId: 'linktitle5'\n  },\n  LINKURL6: {\n    displayName: 'Link to Related Resource 6',\n    sheetId: 'linkurl6'\n  },\n  LINKTITLE6: {\n    displayName: 'Link title 6',\n    sheetId: 'linktitle6'\n  }\n};\n\nconst LINK_FIELD_PAIRS = [\n  { urlField: SHEET_FIELDS.LINKURL1, titleField: SHEET_FIELDS.LINKTITLE1 },\n  { urlField: SHEET_FIELDS.LINKURL2, titleField: SHEET_FIELDS.LINKTITLE2 },\n  { urlField: SHEET_FIELDS.LINKURL3, titleField: SHEET_FIELDS.LINKTITLE3 },\n  { urlField: SHEET_FIELDS.LINKURL4, titleField: SHEET_FIELDS.LINKTITLE4 },\n  { urlField: SHEET_FIELDS.LINKURL5, titleField: SHEET_FIELDS.LINKTITLE5 },\n  { urlField: SHEET_FIELDS.LINKURL6, titleField: SHEET_FIELDS.LINKTITLE6 },\n];\n\nconst FEATURE_HEADERS = {\n  ORGANIZATIONAL: {\n    displayName: 'ORGANIZATIONAL FEATURES',\n    sheetId: null,\n    isFeatureHeader: true\n  },\n  IMPLEMENTATION: {\n    displayName: 'IMPLEMENTATION FEATURES',\n    sheetId: null,\n    isFeatureHeader: true\n  },\n};\n\nconst COMPOSITE_FIELDS = {\n  RELATED_RESOURCES: {\n    displayName: 'Links to Related Resources',\n    sheetId: null,\n    isExpandible: true,\n    isComposite: true\n  }\n};\n\nconst ORDERED_CARD_FIELDS = [\n  // SHEET_FIELDS.LONGITUDE,\n  // SHEET_FIELDS.LATITUDE,\n  // SHEET_FIELDS.EID,\n  // SHEET_FIELDS.NAME,\n  // SHEET_FIELDS.TYPE,\n  SHEET_FIELDS.LOCATION,\n  SHEET_FIELDS.DATES,\n  SHEET_FIELDS.RECIPIENTS,\n  FEATURE_HEADERS.ORGANIZATIONAL,\n  SHEET_FIELDS.IMPLEMENTER,\n  SHEET_FIELDS.RESEARCHER,\n  SHEET_FIELDS.FUNDER,\n  FEATURE_HEADERS.IMPLEMENTATION,\n  SHEET_FIELDS.TARGETING,\n  SHEET_FIELDS.UNIT,\n  SHEET_FIELDS.AMOUNT,\n  SHEET_FIELDS.FREQUENCY,\n  SHEET_FIELDS.EVALUATION,\n  SHEET_FIELDS.NOTES,\n  SHEET_FIELDS.WEBSITE,\n  COMPOSITE_FIELDS.RELATED_RESOURCES\n  // SHEET_FIELDS.LINKURL1,\n  // SHEET_FIELDS.LINKTITLE1,\n  // SHEET_FIELDS.LINKURL2,\n  // SHEET_FIELDS.LINKTITLE2,\n  // SHEET_FIELDS.LINKURL3,\n  // SHEET_FIELDS.LINKTITLE3,\n  // SHEET_FIELDS.LINKURL4,\n  // SHEET_FIELDS.LINKTITLE4,\n  // SHEET_FIELDS.LINKURL5,\n  // SHEET_FIELDS.LINKTITLE5,\n  // SHEET_FIELDS.LINKURL6,\n  // SHEET_FIELDS.LINKTITLE6\n];\n\nexport { SHEET_FIELDS, FEATURE_HEADERS, COMPOSITE_FIELDS, ORDERED_CARD_FIELDS, LINK_FIELD_PAIRS };","import React from 'react';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\n\nclass UserHint extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let classes = 'user-hint';\n    if (this.props.classes) {\n      classes += ` ${this.props.classes}`;\n    }\n    if (this.props.dismissed) {\n      classes += ' dismissed';\n    }\n    \n    return (\n      <div className={classes}>\n        <div className='content'>{this.props.content}</div>\n      </div>\n    )\n  }\n}\n\nexport default UserHint;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport _ from 'lodash';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\nimport { SHEET_FIELDS, ORDERED_CARD_FIELDS, COMPOSITE_FIELDS, LINK_FIELD_PAIRS } from './fields';\nimport UserHint from './UserHint';\n\nconst { LOCATION, NAME, EID, TYPE, WEBSITE } = SHEET_FIELDS;\n\n// pure component? (shallow compare map features?) (perf)\nclass CardDock extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      minimized: true,\n      expandedProperties: {},\n      scrollHintDismissed: false    \n    };\n\n    this.removeCard = this.removeCard.bind(this);\n    this.slideDock = this.slideDock.bind(this);\n    this.toggleDock = this.toggleDock.bind(this);\n    this.maximizeDock = this.maximizeDock.bind(this);\n    this.toggleProperty = this.toggleProperty.bind(this);\n  }\n\n  UNSAFE_componentWillReceiveProps(newProps) {\n    // necessary to ensure smooth height transitions\n    if (newProps.cardData.length !== this.props.cardData.length) {\n      this.setState({ expandedProperties: {} });\n    }\n  }\n\n  removeCard(id) {\n    this.props.removeCard(id);\n  }\n\n  slideDock(e) {\n    if (e.deltaY && e.deltaY > 0) {\n      this.setState({ minimized: false, scrollHintDismissed: true });\n    }\n  }\n\n  toggleDock() {\n    // TODO: call toggle? or remove, make only scroll-controlled\n    this.setState(state => ({ minimized: !this.state.minimized }));\n  }\n\n  maximizeDock() {\n    // TODO: call toggle? or remove, make only scroll-controlled\n    this.setState(state => ({ minimized: false }));\n  }\n\n  toggleProperty(property, expanded) {\n    const expandedProperties = {...this.state.expandedProperties};\n    expandedProperties[property] = !expanded;\n\n    // necessary to ensure smooth height transitions\n    try {\n      const elems = document.getElementsByClassName(`cell ${property}`);\n      const greatestHeight = _.max(_.map(elems, 'scrollHeight'));\n      _.each(elems, elem => {\n        elem.style.maxHeight = greatestHeight + 20 + 'px';\n      })\n    }\n    catch(e) {}\n\n    this.setState({ expandedProperties });\n  }\n\n  getNames() {\n    // TODO: don't bind in render (perf)\n    return this.props.cardData.map((experimentCardSet, idx) => {\n      const {\n        [EID.sheetId]: eid,\n        [NAME.sheetId]: name,\n        [TYPE.sheetId]: type\n      } = experimentCardSet[0];\n      // add type to class so we can color-code\n      const classes = `card card-${idx} ${type}`;\n      return (\n        <div className={classes} key={'header'+eid} >\n          <div className='cell'>\n            {name||'(none)'}\n            <TriggerIcon iconType={ICON_TYPE.REMOVE} onClick={this.removeCard.bind(this, eid)} />\n          </div>\n        </div>\n    )});\n  }\n\n  getRows() {\n    // form a row for each field\n    return ORDERED_CARD_FIELDS.map(field => {\n      const { displayName, sheetId, isFeatureHeader } = field;\n\n      const expandible = this.getIsExpandible(field);\n\n      const expanded = !!this.state.expandedProperties[sheetId];\n\n      let expandIcon = null;\n      if (expandible) {\n        // TODO: also don't bind in render (perf)\n        const iconType = expanded ? ICON_TYPE.COLLAPSE : ICON_TYPE.EXPAND;\n        expandIcon = (\n          <TriggerIcon\n            onClick={this.toggleProperty.bind(this, sheetId, expanded)}\n            iconType={iconType}\n          />\n        );\n      }\n\n      let cellClass = 'cell ' + sheetId;\n      if (expandible) {\n        cellClass += ' expandible';\n      }\n      if (expanded) {\n        cellClass += ' expanded';\n      }\n      if (isFeatureHeader) {\n        cellClass += ' feature-header';\n      }\n\n      // form a cell for each experiment for that field\n      const cells = this.props.cardData.map((experimentCardSet, idx) => {\n\n        const { [EID.sheetId]: eid } = experimentCardSet[0];\n        return (\n          <div className={`card card-${idx}`} key={displayName+eid}>\n            <div className={cellClass}>\n              <div className='property-name'>{displayName}{expandIcon}</div>\n              <div className={'value'}>{this.getCellContent(experimentCardSet, field)}</div>\n            </div>\n          </div>\n      )});\n      \n      return <div className='row' key={displayName}>{cells}</div>;\n    });\n  }\n\n  // whether a given row should be expandible (succinct cells don't need expand triggers)\n  // TODO: use ref, and after rerender check height, add classname accordingly?\n  getIsExpandible(field) {\n    if (field === LOCATION) {\n      // if any experimint in the card dock has multiple locations, the location cell should be expandible\n      return _.some(this.props.cardData, expCardSet => expCardSet.length > 2);\n    }\n    // TODO: should fields designate isExpandible? if so, use here\n    if (field.isComposite || field.isFeatureHeader) {\n      // TODO: should composite rows (Related Resources be expandible? how to measure?)\n      return false;\n    }\n    if (_.some(this.props.cardData, expCardSet => this.getIsDifferentiated(expCardSet, field))) {\n      // if any selected experiment has differentiated data for the field, cell should be expandible\n      return true;\n    }\n\n    // if any experiment's value for the cell is longer than X characters\n    return _.some(this.props.cardData, expCardSet => {\n      // only need to check first location since we only hit this case if cell is undifferentiated\n      return expCardSet[0][field.sheetId].length > 120;\n    });\n  }\n\n  // returns true if the data for a given field of a given experiment\n  // has differing values across experiment locations\n  getIsDifferentiated(experimentCardSet, field) {\n    if (field.forceUniformValue || experimentCardSet.length === 1) {\n      // certain fields we never let be differentiated\n      // and data can't be differentiated if there's only one location\n      return false;\n    }\n    const { sheetId } = field;\n    const [locationOneData, ...otherLocationsData] = experimentCardSet;\n    const firstValue = locationOneData[sheetId];\n    return _.some(otherLocationsData, l => l[sheetId] !== firstValue);\n  }\n\n  getCellContent(experimentCardSet, field) {\n    if (field === LOCATION) {\n      return this.getLocationCellContent(experimentCardSet);\n    } else if (field.isFeatureHeader) {\n      return null;\n    } else if (field === COMPOSITE_FIELDS.RELATED_RESOURCES) {\n      return this.getLinksContent(experimentCardSet);\n    }\n\n    const { sheetId } = field;\n    const firstValue = experimentCardSet[0][sheetId];\n\n    if (field === WEBSITE && firstValue.includes('.')) {\n      // make sure website is linkified if it's a link. otherwise it'll be caught\n      // by the next condition, for all undifferentiated fields\n      return <a href={firstValue} target=\"_blank\">{firstValue}</a>;\n    } else if (!this.getIsDifferentiated(experimentCardSet, field)) {\n      // for undifferentiated fields, the cell content is the field value\n      // for the first (and perhaps only) location\n      return firstValue;\n    }\n    // break cell into block for each location, as they have different values\n    return (\n      <>\n        {experimentCardSet.map(locationData => {\n          const {\n            [EID.sheetId]: eid,\n            [LOCATION.sheetId]: location,\n          } = locationData;\n          return (\n            <div key={`cell-content-${sheetId}-${eid}-${location}`}>\n              <div\n                title={location}\n                className='location-title'\n              >\n                {location}\n              </div>\n              {locationData[sheetId]}\n            </div>\n          )\n        })}\n      </>\n    );\n  }\n\n  getLocationCellContent(experimentCardSet) {\n    const cellContent = experimentCardSet.map(locationData => {\n      const {\n        [EID.sheetId]: eid,\n        [LOCATION.sheetId]: location,\n      } = locationData;\n      return (\n        <div\n          title={location}\n          className='location-cell-content'\n          key={`cell-content-location-${eid}-${location}`}\n        >\n          {location}\n        </div>\n    )});\n    return <>{cellContent}</>;\n  }\n\n  getLinksContent(experimentCardSet) {\n    const linkMap = {};\n    const orderedLinks = [];\n    experimentCardSet.forEach(locationData => {\n      LINK_FIELD_PAIRS.forEach(({ urlField, titleField }) => {\n        const urlValue = locationData[urlField.sheetId];\n        if (urlValue && !linkMap[urlValue]) {\n          linkMap[urlValue] = true;\n          const titleValue = locationData[titleField.sheetId] || urlValue;\n          orderedLinks.push({ urlValue, titleValue });\n        }\n      })\n    });\n\n    return (\n      <div\n        key={`cell-content-links-${experimentCardSet[0][EID.sheetId]}`}\n      >\n        {orderedLinks.map(({ urlValue, titleValue }) => (\n          <a key={urlValue} href={urlValue} target=\"_blank\">{titleValue}</a>\n        ))}\n      </div>\n    );\n  }\n\n  getScrollHint() {\n    const content = (\n    <>scroll for more {<TriggerIcon iconType={ICON_TYPE.D_ARROW} />}</>\n    );\n    return (\n      <UserHint\n        content={content}\n        classes={'scroll-hint'}\n        dismissed={this.state.scrollHintDismissed}\n      />\n    );\n  }\n\n  getSelectionHint() {\n    const content = (\n    <>\n      click more map points to compare experiments<p className='maximum'>(max. 3)</p>\n      <TriggerIcon iconType={ICON_TYPE.R_ARROW} />\n    </>\n    );\n\n    let classes = 'selection-hint';\n\n    if (this.state.scrollHintDismissed) {\n      classes += ' scroll-initiated';\n    }\n    return (\n      <UserHint\n        content={content}\n        classes={classes}\n        dismissed={this.props.selectionHintDismissed}\n      />\n    );\n  }\n\n  render() {\n    if (!this.props.cardData.length) {\n      return null;\n    }\n\n    let classes = `card-dock card-count-${this.props.cardData.length}`;\n    if (!this.state.minimized) {\n      classes += ' maximized';\n    }\n\n    return (\n      <div\n        onWheel={this.slideDock}\n        onDoubleClick={this.toggleDock}\n        onTouchStart={this.maximizeDock}\n        className={'card-dock-container'}\n      >\n        <div className={classes}>\n          <div className=\"card-table\">\n          {this.getScrollHint()}\n          {this.getSelectionHint()}\n            <div className='row header'>{this.getNames()}</div>\n            {this.getRows()}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default CardDock;\n","import React from 'react';\nimport TriggerIcon, { ICON_TYPE } from './TriggerIcon';\n\nclass Legend extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { expanded: true };\n\n    this.toggleExpand = this.toggleExpand.bind(this);\n  }\n\n  toggleExpand() {\n    this.setState(state => ({ expanded: !state.expanded }));\n  }\n\n  render() {\n    let classes = 'legend';\n    if (!this.state.expanded) {\n      classes += ' hidden';\n    }\n\n    const iconType = this.state.expanded ? ICON_TYPE.COLLAPSE : ICON_TYPE.EXPAND;\n    return (\n      <div className={classes}>\n          <TriggerIcon onClick={this.toggleExpand} inBrackets={true} iconType={iconType} />\n          <div className='content'>\n            <div><i className='past' />Past Experiments</div>\n            <div><i className='ongoing' />Ongoing Experiments</div>\n            <div><i className='proposed' />Proposed Experiments</div>\n          </div>\n      </div>\n    )\n  }\n}\n\nexport default Legend;\n","import React from 'react';\n\nconst POINT_BUFFER = 7;\n\nclass Tooltip extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      left: 0,\n      top: 0,\n      adjusted: false\n    };\n\n    this.ref = React.createRef();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const { expId } = nextProps;\n    if (this.props.expId === expId || !expId) {\n      // if we're still hovering the same point, don't worry about updating\n      return;\n    }\n\n    // The following steps insure a tooltip doesn't flow outside of the window bounds:\n    // 1] when we hover a new point, we initially render without adjusting the tooltip location\n    this.setState({ \n      adjusted: false,\n      left: nextProps.x,\n      top: nextProps.y\n    });\n  }\n\n  componentDidUpdate() {\n    if (this.state.adjusted || !this.props.expId) {\n      // 6] location has already been adjusted, so don't trigger a rerender\n      return;\n    }\n\n    this.adjustPosition();\n  }\n\n  adjustPosition() {\n    // 3] after the initial render, we have access to the tooltip's DOM node and can tell it's size\n    const { width: tooltipWidth, height: tooltipHeight } = this.ref.current.getBoundingClientRect();\n    const windowElement = document.getElementById('root');\n    const { width: windowWidth, height: windowHeight } = windowElement.getBoundingClientRect();\n    \n    let { left, top } = this.state;\n    // by default, tooltip appears above the point\n    top -= (tooltipHeight + POINT_BUFFER);\n    if (top < 0) {\n      // if it would run off the top of the screen, shift it below the point\n      top += tooltipHeight + POINT_BUFFER*2;\n\n      if ((top + tooltipHeight) > windowHeight) {\n        // ...unless it would then run off the bottom, in which case set it as high as possible\n        top = 1;\n      }\n    }\n\n    left += POINT_BUFFER;\n    if (left + tooltipWidth > windowWidth) {\n      // if the tooltip would run off the right of the screen, shift it left of the point\n      left -= (tooltipWidth + POINT_BUFFER*2);\n\n      if (left < 0) {\n        // ...unless it would then run off the left, in which case set it up against the right border\n        left = windowWidth - (tooltipWidth + 2);\n      }\n    }\n\n    // 4] record our adjusted coordinates, which will trigger a rerender\n    this.setState({ left, top, adjusted: true });\n  }\n  \n  getLocations() {\n    const { location, otherLocations } = this.props;\n    let hoveredClass = 'hovered-location';\n    let otherLocationElements = null;\n\n    if (otherLocations.length) {\n      hoveredClass += ' emphasized';\n      otherLocationElements = otherLocations.map(l => <p key={l}>{l}</p>);\n    }\n\n    return (\n      <>\n        <p className={hoveredClass}>{location}</p>\n        {otherLocationElements}\n      </>\n    )\n  }\n\n  render() {\n    const { expId, name, type } = this.props;\n    if (!expId) {\n      return null;\n    }\n\n    let style = {};\n    if (!this.state.adjusted) {\n      // 2] hide this initial render so user doesn't see tooltip \"jump\"\n      style = { visibility: 'hidden', left: '0px', top: '0px' };\n    } else {\n      // 5] finally, our tooltip can be told where to properly render\n      style = { left: this.state.left + 'px', top: this.state.top + 'px' };\n    }\n\n    const classes = 'tooltip ' + type;\n    return (\n      <div className={classes} style={style} ref={this.ref}>\n        <div className='name'>{name||'(none)'}</div>\n        <div className='detail'>\n          <p className='location-title'>Location:</p>\n          {this.getLocations()}\n        </div>\n        <p className='click-hint'>click point for more info</p>\n      </div>\n    )\n  }\n}\n\nexport default Tooltip;\n","import CardDock from './CardDock';\nimport Legend from './Legend';\nimport React from 'react';\nimport Tooltip from './Tooltip';\nimport mapboxgl from 'mapbox-gl';\nimport _ from 'lodash';\nimport styleData from './style.json';\nimport './App.scss';\nimport { SHEET_FIELDS } from './fields';\n\nconst { LONGITUDE, LATITUDE, NAME, LOCATION, TYPE, EID } = SHEET_FIELDS;\n\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN;\nconst MAX_SELECTED_POINTS = 3;\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lat: 40,\n      lng: -98,\n      zoom: 3,\n      hovered: {},\n      selectedIds: [],\n      isTouchScreen: false,\n      selectionHintDismissed: false\n    };\n\n    this.map = null;\n    this.getCardDock = this.getCardDock.bind(this);\n    this.getTooltip = this.getTooltip.bind(this);\n    this.removeCard = this.removeCard.bind(this);\n    this.getFeaturesByExperimentId = this.getFeaturesByExperimentId.bind(this);\n  }\n\n  componentDidMount() {\n    this.map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: styleData,\n      center: [this.state.lng, this.state.lat],\n      zoom: this.state.zoom,\n    });\n    \n    this.map.on('move', () => {\n      this.featuresOnUnhover();\n      console.log('lat: ', this.map.getCenter().lat.toFixed(4));\n      console.log('lng: ', this.map.getCenter().lng.toFixed(4));\n      console.log('zoom: ', this.map.getZoom().toFixed(2));\n      this.setState({\n        lng: this.map.getCenter().lng.toFixed(4),\n        lat: this.map.getCenter().lat.toFixed(4),\n        zoom: this.map.getZoom().toFixed(2)\n      });\n    });\n    \n    this.map.on('load', this.removeMapMask.bind(this));\n\n    this.map.on('click', 'experimentSites', this.featuresOnClick.bind(this));\n    this.map.on('mouseenter', 'experimentSites', this.featuresOnHover.bind(this));\n    this.map.on('mouseleave', 'experimentSites', this.featuresOnUnhover.bind(this));\n\n    this.map.on('touchstart', 'experimentSites', this.registerTouchScreen.bind(this));\n    \n    load.call(this); \n  }\n  \n  removeMapMask() {\n    console.log('MAP LOADED', new Date);\n  }\n\n  registerTouchScreen() {\n    this.setState({ isTouchScreen: true });\n  }\n\n  getFeaturesByExperimentId(expId) {\n    const { features } = this.map.getSource('experiments')._data;\n    return features.filter(f => f.id === expId).map(f => f.properties);\n  }\n  \n  featuresOnClick(e) {\n    const { id: expId } = e.features[0];\n    const selectedIds = [...this.state.selectedIds];\n    const idx = selectedIds.indexOf(expId);\n    const alreadySelected = idx > -1;\n\n    if (!alreadySelected) {\n      if (selectedIds.length >= MAX_SELECTED_POINTS) {\n        console.log('OH SHET!');\n        // warn user\n        return;\n      } else {\n        selectedIds.push(expId);\n      }\n    } else {\n      selectedIds.splice(idx, 1);\n    }\n\n    // dismiss selection hint once multiple points have been selected\n    const selectionHintDismissed = (selectedIds.length > 1) || this.state.selectionHintDismissed;\n    this.setState({ selectedIds, selectionHintDismissed });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { selected: !alreadySelected }\n    );\n  }\n\n  featuresOnHover(e) {\n    if (this.state.isTouchScreen) {\n      // devices with touch screens shouldn't have tooltips\n      return;\n    }\n    this.map.getCanvas().style.cursor = 'pointer';\n    const { id: expId, properties } = e.features[0];    \n    const { x, y } = e.point;\n\n    this.setState({ \n      hovered: {\n        name: properties[NAME.sheetId],\n        location: properties[LOCATION.sheetId],\n        type: properties[TYPE.sheetId],\n        expId,\n        x,\n        y \n      }\n    });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { hover: true }\n    );\n  }\n\n  featuresOnUnhover() {\n    if (this.state.isTouchScreen || !this.state.hovered.expId) {\n      return;\n    }\n    this.map.getCanvas().style.cursor = '';\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: this.state.hovered.expId\n      }, { hover: false }\n    );\n\n    this.setState({ hovered: {} });\n  }\n\n  removeCard(expId) {\n    const selectedIds = [...this.state.selectedIds];\n    const idx = selectedIds.indexOf(expId);\n    selectedIds.splice(idx, 1);\n\n    this.setState({ selectedIds });\n    this.map.setFeatureState({\n        source: 'experiments',\n        id: expId\n      }, { selected: false }\n    );\n  }\n\n  getTooltip() {\n    const { expId, name, location, type, x, y } = this.state.hovered;\n    let otherLocations = [];\n    if (expId) {\n      const features = this.getFeaturesByExperimentId(expId);\n      otherLocations = features\n        .map(f => f.location)\n        .filter(l => l !== location);\n    }\n    return <Tooltip expId={expId} name={name} location={location} otherLocations={otherLocations} type={type} x={x} y={y}/>;\n  }\n\n  getCardDock() {\n    if (!this.map) {\n      return null;\n    }\n\n    const { selectedIds, isTouchScreen, selectionHintDismissed } = this.state;\n    const cardData = selectedIds.map(this.getFeaturesByExperimentId);\n    return (\n      <CardDock\n        removeCard={this.removeCard}\n        cardData={cardData}\n        isTouchScreen={isTouchScreen}\n        selectionHintDismissed={selectionHintDismissed}\n      />\n    );\n  }\n  \n  render() {\n    return (\n      <div className='app'>\n        {this.getCardDock()}\n        {this.getTooltip()}\n        <div ref={el => this.mapContainer = el} className='map-container' />\n        <Legend />\n      </div>\n    );\n  }\n}\n\nlet nextEidNumber = 1;\nconst eidMap = {};\n\nfunction load () {\n  // startsWith polyfill\n  if (!String.prototype.startsWith) {\n    Object.defineProperty(String.prototype, 'startsWith', {\n        value: function(search, rawPos) {\n            const pos = rawPos > 0 ? rawPos|0 : 0;\n            return this.substring(pos, pos + search.length) === search;\n        }\n    });\n  }\n\n  const experimentsData = { type: 'FeatureCollection', features: [] };\n\n  const reqHandler = (source, req) => {\n    const [ columnHeaderRow, ...rows ] = JSON.parse(req.responseText).feed.entry;\n    console.log('TWO', new Date);\n    const properties = Object.keys(rows[0])\n      .filter(function (p) { \n        return p.startsWith('gsx$') & !p.endsWith('_db1zf');\n      })\n      .map(function (p) { return p.substr(4); });\n    \n    const items = rows.map(function (r, ri) {\n      const row = {};\n      properties.forEach(function (p) {\n        row[p] = r['gsx$' + p].$t === '' ? null : r['gsx$' + p].$t;\n        if ([LATITUDE.sheetId, LONGITUDE.sheetId].indexOf(p) !== -1) {\n          // mapbox wants numeric lat/long\n          row[p] = +row[p];\n        }\n        if (p === EID.sheetId) {\n          // convert the string eids from the sheet into numeric ids (which mapbox expects)\n          const stringEid = row[p];\n          const numericEid = eidMap[stringEid] || nextEidNumber++;\n          eidMap[stringEid] = numericEid;\n          row[p] = numericEid;\n        }\n        if (p === TYPE.sheetId) {\n          // force lower case to simplify equality comparisons\n          row[p] = row[p].toLowerCase();\n        }\n        if (row[p] === null) {\n          row[p] = '';\n        }\n      });\n      return {\n        type: 'Feature',\n        id: row[EID.sheetId],\n        geometry: {\n          type: 'Point',\n          coordinates: [row[LATITUDE.sheetId], row[LONGITUDE.sheetId]]\n        },\n        properties: row\n      };\n    });\n    \n    experimentsData.features.push(...items);\n    this.map.getSource('experiments').setData(experimentsData);\n    console.log('THREE', new Date);\n  }\n\n  // Fetch Local Article Data\n  const experimentsReq = new XMLHttpRequest();\n  console.log('ONE', new Date);\n  experimentsReq.addEventListener('load',  () => { reqHandler('experiments', experimentsReq) });\n  experimentsReq.open('GET', process.env.REACT_APP_SHEET_URL);\n  experimentsReq.send();\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}